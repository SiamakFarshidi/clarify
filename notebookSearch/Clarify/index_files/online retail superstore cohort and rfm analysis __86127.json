{"name": "online retail superstore cohort and rfm analysis ", "full_name": " h1 Retail Capstone Project h2 Problem Statement h2 Dataset Description h3 Variables Description h4 Import Libraries h4 Set relative path of input files h4 Import Input Datasets h4 Import Bonus Country Country Code Mapping Dataset for Tableau Visualization h2 Data Cleaning n h2 Data Pre processing n h4 Check Shape of Input Train Dataset h4 Validate First Few Records of Input train dataframe h4 Check the shape of Test Dataframe h4 Validate First Few Records of Input Test Dataframe h4 Concatenate train and test Dataframes into Single Merged dataframe data h4 Validate First Few Records of data Dataframe h4 Identify Missing Values and Type of Data using data info h4 Identify statistics of numeric data using describe h4 Identify Duplicates h4 Drop Identified Duplicates h4 Identify count of CustomerID which have Valid Data h4 Validate percentage of missing customer IDs h4 Retain only records where CustomerID is populated and drop the remaining 25 h4 Recheck the missing values information on data dataframe h4 Change the case of column Description from Upper to Title Proper for better readability h4 Change the DType of CustomerID to Integer h4 Change the DType of CustomerID to String h4 Purchase Transactions Split By Country h4 Plot Bar Plot Transaction Count of Purchases by Country h4 Summarize Top 3 Countries Transactions Count as Percentage h4 Create Feature Total Cost as Quantity UnitPrice h4 Overall Purchase by Country h4 Average Purchase Per Transaction by Country h4 Transaction Spread by Year h4 Transaction Spread by Month for Year 2011 h4 Top 20 Purchase Split By Item Description h4 Top 20 Purchases by Invoices h4 Plot Bar Plot Top 20 Purchases by Invoice Number h4 Bottom 20 Purchases by Invoices h4 Plot Bar Plot Bottom 20 Purchases by Invoice Number h4 Top 20 Customers by Spending h3 Handling Inappropriate Data h4 Boxplot on Quantity to Identify Outliers in Data Distribution h4 InterQuartile Range IQR 1 5 IQR Rule on Quantity to Identify Outliers in Data Distribution h4 Records with Quantity 0 and records with Quantity 20000 which are cancelled are removed h4 Validate Quantity Distribution after removing inappropriate data h4 Perform Boxplot Test for Outliers on UnitPrice h4 Perform IQR Test for Outliers on UnitPrice h4 Visualise the UnitPrice Distribution h4 Records with UnitPrice Less than 0 are removed n h4 Boxplot Validation on UnitPrice after removing inappropriate data h4 Check Input Data Spread until and after December 2011 h4 Remove Partial Month Data of December 2011 h4 Post EDA Validation of Top 20 Customers by Spend h4 EDA on Countries Dataframe h4 Create Dataframe dataTableau merging EDA completed dataframe data and EDA completed dataframe countries on Country using left join n h4 Add Region column based on Country value to classify as UK and Others for Visualization n h4 Add MonthYear column based on InvoiceDate to filter for Visualization Tableau gives MonthYear in long format and take space hence export in short form from Python n h4 Check Info of dataTableau dataframe to validate DType and Missing Values n h4 Compute Number of Refunded Invoices for Tableau Visualization KPI n h4 Create Dataframe refundedInvoices to compute count of Distinct Refunded Invoices for Tableau Visualization KPI h3 Data Cleaning Completed h3 Data Transformation h4 Copy cleaned EDA dataframe data into cohortdata dataframe for cohort analysis n h4 Perform head operation on cohortdata to check data integrity n h3 Cohort Analysis n h4 Types of cohorts n h4 For cohort analysis there are a few labels that we have to create h4 Elements of cohort analysis h3 Create month cohorts and analyze active customers for each cohort h4 Monthly Cohort Assignment h4 Compute time offset in months for InvoiceMonth and CohortMonth to obtain Year and Month n h4 Compute Cohort Index using the year and month parts of cohort and invoice dates h4 Compute Ordered Month List for usage on HeatMaps on CohortMonth n h4 Sum Total of Items Purchased Spread by CohortMonth n h4 Cohort Monthly Customer Count Heatmap n h4 Sum Total of Gift Items Purchased Spread by CohortMonth h4 Plot Bar Graph on dataframe TotalPurchase n h4 Create Heatmap on Total Items Purchased Spread by Cohort Month n h4 Cohort Mean Quantity of Gift Items Purchased Spread by CohortMonth h3 Analyse the retention rate of customers h4 Create summarization cohortGroup on CohortMonth and CohortIndex h4 Compute Retention Rate h4 Create Heatmap Customer Retention Rate Spread by Cohort Month in Percentage h3 Data Transformation Completed h3 Data Modeling h3 Build a RFM Recency Frequency Monetary model h3 RFM Analysis h4 Benefits of RFM analysis h4 Copy EDA completed Data dataframe into RFMData for RFM Analysis h4 Perform head operation on RFMData to check data integrity h3 Recency h4 Create a hypothetical snapshot currentDate data as if we re doing analysis recently h4 Compute Recent Purchase Date column to have Date part alone of Invoice date h4 Compute Recency by Grouping RFMData on CustomerID and Maximum of RecentPurchaseDate h4 Add column CurrentDate column to Recency Dataframe n h4 Compute Recency Column as difference between current date and RecentPurchaseDate n h4 Data Clean Up Drop Columns RecentPurchaseDate and CurrentDate h4 Data Integrity Shape Check on Recency Dataframe n h3 Frequency n h4 Compute Frequency Dataframe grouping on Customer ID by count of InvoiceNo n h4 Data Shape Quality Check on Frequency Dataframe n h3 Monetary n h4 Compute Monetary Value Dataframe grouping on Customer ID by sum of TotalCost n h4 Data Shape Quality Check on monetary Dataframe n h3 Build RFM Table n h4 Combine Recency Frequency and Monetary into aggregated RFMModel dataframe n h4 Data Shape Quality Check on RFMModel Dataframe n h4 Data Integrity Check on Unique Customers on Baselined Data dataframe n h4 Set Customer ID as index for RFMModel dataframe n h3 Validate RFM Table Integrity from Customer ID R F am M perspectives n h4 Match RFMData Customer ID and RFMModel Index and display the head of the comparison result in RFMData n h4 Validate Recency for first Customer ID n h4 RFM Recency Frequency Monetary model RFMModel created n h3 Build RFM Segments Give recency frequency and monetary scores individually by dividing them into quartiles h4 Create RFM Score for R F and M on a scale of 1 to 4 and concatenate as string to assign Customer Segment h4 Create Quartiles Dictionary for RFM h4 Create Quantiles Dataframe for RFM n h4 Plot Recency Quantiles Distribution n h4 Plot Frequency Quantiles Distribution h4 Monetary Quantiles Distribution h4 Plot Quantiles Distribution Bar Spread 0 25 50 75 n h4 RFM Quantile Summary h4 Copy RFMModel dataframe into RFMSegment for RFM Segment Table n h4 Perform head operation on RFMSegment to check data integrity n h4 Compute R F and M Quantiles for each Customer ID n h4 Compute R Quantile n h4 Compute F Quantile n h4 Compute M Quantile n h4 Build RFM Segment and RFM Score n h4 Print RFM Unique String Values n h4 Validate RFMSegment Information n h4 Reset the index of RFMSegment Dataframe n h4 Data Integrity Check on RFMSegment n h4 Below is a table with key RFM segments n h4 Create segment customer function on RFMtable created above to map RFM segments to customer segments n h4 Check head of RFMSegment Dataframe for Data Integrity n h4 Check the distribution of CustomerSegment h4 Random Sample on RFMSegment to check data h4 Grouping by RFM Score for Market Campaigns To be used in visualization n h4 Customer Segment Spread by Categories h3 Data Modeling Completed For n h3 Data Modeling n h3 Create clusters using k means clustering algorithm n h4 Prepare the data for the algorithm If the data is asymmetrically distributed manage the skewness with appropriate transformation Standardize the data n h4 Check Description of Dataframe RFMModel to identify negative values n h4 Log Transformation of RFMModel and Scaling the Transformed Log Model into Scaled Model RFMModelScaled n h4 Revalidate Distribution Subplot to check data skewness after log transformation and scaling n h4 Decide the optimum number of clusters to be formed using Kmeans n h4 Compute Within Cluster Sum of Squares WCSS Error through Elbow Method h4 Plot WCSS Elbow Graph from computed WCSS Inertia Dataframe WCSSKmeansOut n h4 Validate silhouette Score n h4 Check Silhouette score Dataframe to Validate Cluster with maximum score n h4 Decide the optimum number of clusters to be formed as 4 n h4 Build KMeans Model with 4 Clusters and fix random state as 1 to ensure no variation during rerun n h4 Print the KMeans Model h4 Validate if of entries cluster label array matches RFMSegment dataframe size in terms of rows should be equal to count of customer IDs n h4 Build ClusterData Table n h4 Check Shape of Dataframe ClusterData h4 Identify Split of customer ID s by Cluster h4 Create BoxPlot on Cluster Count Spread h4 Sample the Cluster Table data to check correctness h4 Analyze these clusters and comment on the results n h4 Sample the Cluster Table data for Cluster 3 n h4 Sample the Cluster Table data for Cluster 2 h4 Sample the Cluster Table data for Cluster 1 n h4 Sample the Cluster Table data for Cluster 0 n h4 Scatter Plot n h4 Snake Plot n h4 Dataframe Melt n h4 Check shape of RFMModelScaledMelt dataframe n h4 RFM Snake Plot Visualization n h4 Heat Map h4 Clusterwise Related Dependence Heatmap h4 Check Customer Segment Spread for Cluster 0 n h4 Check Customer Segment Spread for Cluster 1 n h4 Check Customer Segment Spread for Cluster 2 n h4 Check Customer Segment Spread for Cluster 3 h3 Data Modeling Completed for h3 Data Reporting h4 Export Dataframes Data and ClusterData to Excel h4 Tableau Visualization n h3 Data Reporting Completed ", "stargazers_count": 0, "forks_count": 0, "description": " h1 style color SteelBlue text align center Retail Capstone Project h1 h2 style color DodgerBlue text align left Problem Statement h2 p It is a critical requirement for business to understand the value derived from a customer RFM is a method used for analyzing customer value Customer segmentation is the practice of segregating the customer base into groups of individuals based on some common characteristics such as age gender interests and spending habits Perform customer segmentation using RFM analysis The resulting segments can be ordered from most valuable highest recency frequency and value to least valuable lowest recency frequency and value p h2 style color DodgerBlue text align left Dataset Description h2 p This is a transnational data set which contains all the transactions that occurred between 01 12 2010 and 09 12 2011 for a UK based and registered non store online retail The company mainly sells unique and all occasion gifts p h3 style color MediumBlue text align left Variables Description h3 table style width 100 text align left tr style color Crimson th style text align center Item th th style text align center Purpose th th style text align center Type th th style text align center Metadata Description th tr tr td style text align left InvoiceNo td td style text align left Invoice number td td style text align left Nominal td td style text align left A six digit integral number uniquely assigned to each transaction If this code starts with letter c it indicates a cancellation td tr tr td style text align left StockCode td td style text align left Product item code td td style text align left Nominal td td style text align left A five digit integral number uniquely assigned to each distinct product td tr tr td style text align left Description td td style text align left Product item name td td style text align left Nominal td td style text align left Product item name td tr tr td style text align left Quantity td td style text align left The quantities of each product item per transaction td td style text align left Numeric td td style text align left The quantities of each product item per transaction td tr tr td style text align left InvoiceDate td td style text align left Invoice Date and time td td style text align left Numeric td td style text align left The day and time when each transaction was generated td tr tr td style text align left UnitPrice td td style text align left Unit price td td style text align left Numeric td td style text align left Product price per unit in sterling td tr tr td style text align left CustomerID td td style text align left Customer number td td style text align left Nominal td td style text align left A six digit integral number uniquely assigned to each customer td tr tr td style text align left Country td td style text align left Country name td td style text align left Nominal td td style text align left The name of the country where each customer resides td tr table h4 style color Navy Import Libraries h4 h4 style color Navy Set relative path of input files h4 h4 style color Navy Import Input Datasets h4 h4 style color Navy Import Bonus Country Country Code Mapping Dataset for Tableau Visualization h4 h2 style color DodgerBlue text align left Data Cleaning h2 h2 style color MediumBlue text align left Data Pre processing h2 h4 style color Navy Check Shape of Input Train Dataset h4 h5 Inference s h5 ul li train dataframe has 379336 rows of information and 8 columns li ul h4 style color Navy Validate First Few Records of Input train dataframe h4 h5 Inference s h5 ul li Train Dataframe has nan value on CustomerID Column for first record li li Data quality check successful on first 5 rows validation li ul h4 style color Navy Check the shape of Test Dataframe h4 h5 Inference s h5 ul li test Dataframe has 162573 rows of information and 8 columns li ul h4 style color Navy Validate First Few Records of Input Test Dataframe h4 h5 Inference s h5 ul li test Dataframe has 2 nan value on CustomerID Column in the first 5 records li li Data quality check successful on first 5 rows validation li ul h4 style color Navy Concatenate train and test Dataframes into Single Merged dataframe data h4 h5 Inference s h5 ul li data Dataframe has 541909 rows of information and 8 columns li ul h4 style color Navy Validate First Few Records of data Dataframe h4 h5 Inference s h5 ul li data Dataframe displays fine and has 8 columns li li Description column is in Capitals and can be converted to Title Proper Case after numeric EDA li li Data quality check successful on first 5 rows validation li ul h4 style color Navy Identify Missing Values and Type of Data using data info h4 h5 Inference s h5 ul li Missing values are found on CustomerID and Description columns li li 4 Object Columns InvoiceNo StockCode Description Country li li 1 Integer Columns Quantity li li 2 Float Columns UnitPrice CustomerID li li 1 Datetime Columns InvoiceDate li ul h4 style color Navy Identify statistics of numeric data using describe h4 h5 Inference s h5 ul li UnitPrice has negative values and potential outliers beyond 75 percentile li li Quantity has negative values refunds and has potential outliers beyond 75 percentile and below 25th percentile li li Let s ignore CustomerID describe statistics as its actually unique ordinal li ul h4 style color Navy Identify Duplicates h4 h5 Inference s h5 ul li Less than 1 duplicates found let s drop them before moving forward li ul h4 style color Navy Drop Identified Duplicates h4 h5 Inference s h5 ul li data dataframe now has 536641 unique rows and 8 columns after removing duplicates li ul h4 style color Navy Identify count of CustomerID which have Valid Data h4 h5 Inference s h5 ul li 401604 rows out of 536641 have CustomerID Populated li ul h4 style color Navy Validate percentage of missing customer IDs h4 h5 Inference s h5 ul li b 25 1 b records have b Customer ID b Missing li li Apt strategy is to b remove b these records li ul h4 style color Navy Retain only records where CustomerID is populated and drop the remaining 25 h4 h5 Inference s h5 li data Dataframe has b 401604 b records retained with b 8 b Columns li h4 style color Navy Recheck the missing values information on data dataframe h4 h5 Inference s h5 ul li b No b missing values found in data dataframe for any of the b 8 b Columns li ul h4 style color Navy Change the case of column Description from Upper to Title Proper for better readability h4 h5 Inference s h5 ul li data Dataframe displays fine and has 8 columns li li Description column converted to Title Proper Case li li Data quality check successful on first 5 rows validation li ul h4 style color Navy Change the DType of CustomerID to Integer h4 h5 Inference s h5 ul li data Dataframe displays fine and has 8 columns li li CustomerID column converted to Integer Type li li Data quality check successful on first 5 rows validation li ul h4 style color Navy Change the DType of CustomerID to String h4 h5 Inference s h5 ul li data Dataframe has 8 columns and 401604 rows li li CustomerID column converted to String Type li ul h4 style color Navy Purchase Transactions Split By Country h4 h5 Inference s h5 ul li b groupByCountry b dataframe summarized at Country level aggregating count on InvoiceNo li ul h4 style color Navy Plot Bar Plot Transaction Count of Purchases by Country h4 h5 Inference s h5 ul li b United Kingdom UK b tops on transactions with b over 356K b transactions li ul h4 style color Navy Summarize Top 3 Countries Transactions Count as Percentage h4 h5 Inference s h5 ul li b United Kingdom b has approximately b 89 b of Purchase Sales Split By Country li ul h4 style color Navy Create Feature Total Cost as Quantity UnitPrice h4 h5 Inference s h5 ul li b TotalCost b column added as last column of dataframe data and first 5 rows displays right computation as multiplication product of UnitPrice and Quantity li li Data quality check successful on first 5 rows validation li ul h4 style color Navy Overall Purchase by Country h4 h5 Inference s h5 ul li Saudi Arabia ranked lowest on Overall Purchases li li UK ranked highest on Overall Purchases b greater than 6 75 Million b li ul h4 style color Navy Average Purchase Per Transaction by Country h4 h5 Inference s h5 ul li USA ranked lowest on Mean Purchases 6 per transaction li li Netherlands ranked highest on Mean Purchases greater than 120 per transaction li ul h4 style color Navy Transaction Spread by Year h4 h5 Inference s h5 ul li 2011 had more than 375K transactions li ul h4 style color Navy Transaction Spread by Month for Year 2011 h4 h5 Inference s h5 ul li Feb 2011 ranked lowest on Purchases in 2011 with 19800 transactions li li Nov 2011 ranked highest on Purchases in 2011 with 64000 transactions li li Dec 2011 had partial month data and hence had significantly lower volume of transactions li ul h4 style color Navy Top 20 Purchase Split By Item Description h4 h5 Inference s h5 ul li Most Procured Item b White Hanging Heart T Light Holder b li ul h4 style color Navy Top 20 Purchases by Invoices h4 h5 Inference s h5 ul li b groupByTotalCost b dataframe summarized at InvoiceNo level aggregating sum of TotalCost for Top 20 Invoices li li Data quality check successful on first 5 rows validation li ul h4 style color Navy Plot Bar Plot Top 20 Purchases by Invoice Number h4 h5 Inference s h5 ul li Customer 16446 from UK has shopped for 168 5K on a single transaction 581483 for Birdie Paper Craft li ul h4 style color Navy Bottom 20 Purchases by Invoices h4 h5 Inference s h5 ul li b groupByTotalCost2 b dataframe summarized at InvoiceNo level aggregating sum of TotalCost for Bottom 20 Invoices li li Data quality check successful on first 5 rows validation li ul h4 style color Navy Plot Bar Plot Bottom 20 Purchases by Invoice Number h4 h5 Inference s h5 ul li We infer that the top 2 invoices were cancelled and refunded li ul h4 style color Navy Top 20 Customers by Spending h4 h5 Inference s h5 ul li Customer 14646 from Netherlands has shopped for 279K during the given period which is the maximum li ul h3 style color DarkBlue Handling Inappropriate Data h3 h4 style color Navy Boxplot on Quantity to Identify Outliers in Data Distribution h4 h5 Inference s h5 ul li Quantity has outliers spread on both sides and needs further preprocessing li ul h4 style color Navy InterQuartile Range IQR 1 5 IQR Rule on Quantity to Identify Outliers in Data Distribution h4 h5 Inference s h5 ul li Quantity outliers found based on IQR test on both sides li ul h5 Inference s h5 ul li More than 2 quantity is negative indicating returns refunds li ul h5 Inference s h5 ul li 4 significant outlier records with 2 on either side of the distribution are present in quantity which was earlier highlighted in boxplot li ul h4 style color Navy Records with Quantity 0 and records with Quantity 20000 which are cancelled are removed h4 h5 Inference s h5 ul li 2 percent negative quantity items removed li li 2 Positive outlier quantities 20000 which were part of refunds are removed li ul h4 style color Navy Validate Quantity Distribution after removing inappropriate data h4 h5 Inference s h5 ul li Boxplot on quantity shows positive distribution with 1 valid high value li ul h4 style color Navy Perform Boxplot Test for Outliers on UnitPrice h4 h5 Inference s h5 ul li Boxplot shows unit price positive distribution with 1 high value outlier li ul h4 style color Navy Perform IQR Test for Outliers on UnitPrice h4 h5 Inference s h5 ul li IQR shows unit price high positive outlier lets ignore as its valid li ul h4 style color Navy Visualise the UnitPrice Distribution h4 h5 Inference s h5 ul li There are about 0 01 items where unit price is 0 free items li ul h4 style color Navy Records with UnitPrice Less than 0 are removed h4 h5 Inference s h5 ul li 40 items with unit price 0 removed li ul h4 style color Navy Boxplot Validation on UnitPrice after removing inappropriate data h4 h5 Inference s h5 ul li Boxplot shows unit price positive distribution with 1 high value valid outlier li ul h4 style color Navy text align left Check Input Data Spread until and after December 2011 h4 h5 Inference s h5 ul li Above 4 of overall data is part of December 2011 where we have partial month data li ul h4 style color Navy Remove Partial Month Data of December 2011 h4 h5 Inference s h5 ul li style color Purple December 2011 Partial Month data removed li ul h4 style color Navy Post EDA Validation of Top 20 Customers by Spend h4 h5 Inference s h5 ul li After EDA preprocessing Customer 14646 from Netherlands has shopped for 268K during the given period which is the maximum li ul h4 style color Navy EDA on Countries Dataframe h4 h5 Inference s h5 ul li EDA on Countries showed missing values of country code for 4 countries and they were removed li ul h4 style color Navy Create Dataframe dataTableau merging EDA completed dataframe data and EDA completed dataframe countries on Country using left join h4 h5 Inference s h5 ul li Merged Dataframe dataTableau created and the first 5 rows validated fine li ul h4 style color Navy Add Region column based on Country value to classify as UK and Others for Visualization h4 h5 Inference s h5 ul li Region column added to dataTableau dataframe and validated fine while checking the head li ul h4 style color Navy Add MonthYear column based on InvoiceDate to filter for Visualization Tableau gives MonthYear in long format and take space hence export in short form from Python h4 h5 Inference s h5 ul li MonthYear column added to dataTableau dataframe and validated fine while checking the head li ul h4 style color Navy Check Info of dataTableau dataframe to validate DType and Missing Values h4 h5 Inference s h5 ul li Dataframe dataTableau has 375665 rows of information which matches the count of rows on data Dataframe and there are no missing values ready for Tableau Visualization with additional data of Country Code Region and InvoiceMonth li ul h4 style color Navy Compute Number of Refunded Invoices for Tableau Visualization KPI h4 h5 Inference s h5 ul li 20 Unique refund invoices found li ul h4 style color Navy Create Dataframe refundedInvoices to compute count of Distinct Refunded Invoices for Tableau Visualization KPI h4 h5 Inference s h5 ul li Dataframe refundedInvoices created with 1 row having RefundedInvoices count li ul h3 style color MediumBlue Data Cleaning Completed h3 ul li 1 Performed preliminary data inspection and data cleaning ul li a Checked for missing data and formulated an apt strategy to treat them li li b Removed duplicate data records li li c Performed descriptive analytics on the given data li ul li ul h3 style color MediumBlue text align left Data Transformation h3 h4 style color Navy Copy cleaned EDA dataframe data into cohortdata dataframe for cohort analysis h4 h5 Inference s h5 ul li cohortdata dataframe has 375665 rows of data spread across 9 columns which matches the data dataframe li ul h4 style color Navy Perform head operation on cohortdata to check data integrity h4 h5 Inference s h5 ul li cohortdata dataframe passed data integrity test on examining head of the data li ul h3 style color MediumBlue text align left Cohort Analysis h3 p What is Cohort Analysis p p A cohort is a group of subjects who share a defining characteristic We can observe how a cohort behaves across time and compare it to other cohorts p ul li Mutually exclusive segments cohorts li li Compare metrics across product lifecycle li li Compare metrics across customer lifecycle li ul h4 style color Navy text align left Types of cohorts h4 ul li b Time Cohorts b are customers who signed up for a product or service during a particular time frame Analyzing these cohorts shows the customers behavior depending on the time they started using the company s products or services The time may be monthly or quarterly even daily li li b Behavior cohorts b are customers who purchased a product or subscribed to a service in the past It groups customers by the type of product or service they signed up Customers who signed up for basic level services might have different needs than those who signed up for advanced services Understanding the needs of the various cohorts can help a company design custom made services or products for particular segments li li b Size cohorts b refer to the various sizes of customers who purchase company s products or services This categorization can be based on the amount of spending in some periodic time after acquisition or the product type that the customer spent most of their order amount in some period of time li ul h4 style color Navy text align left For cohort analysis there are a few labels that we have to create h4 ul li b Invoice period b A string representation of the year and month of a single transaction invoice li li b Cohort group b A string representation of the year and month of a customer s first purchase This label is common across all invoices for a particular customer li li b Cohort period Index b An integer representation a customer s stage in its lifetime The number represents the number of months passed since the first purchase li ul h4 style color Navy text align left Elements of cohort analysis h4 ul li Pivot table li li Assigned cohort in rows li li Cohort Index in columns li li Metrics in the table li ul h3 style color MediumBlue text align left Create month cohorts and analyze active customers for each cohort h3 h4 style color Navy text align left Monthly Cohort Assignment h4 p Setting up a cohort is the pre cursor to perform cohort analysis Based on 12 month data provided assigning customers to cohorts based on date of first purchase based on data provided for performig cohort analysis p h5 Inference s h5 ul li InvoiceMonth Column computed from InvoiceDate having only the date part li li CohortMonth Column computed based on month of first purchase li ul h4 style color Navy text align left Compute time offset in months for InvoiceMonth and CohortMonth to obtain Year and Month h4 h5 Inference s h5 ul li obtainDateInterval function run on InvoiceMonth and CohortMonth to parse the year and month parts li ul h4 style color Navy text align left Compute Cohort Index using the year and month parts of cohort and invoice dates h4 h5 Inference s h5 ul li Cohort Index generates fine and head data validated fine li ul h4 style color Navy text align left Compute Ordered Month List for usage on HeatMaps on CohortMonth h4 h5 Inference s h5 ul li Ordered List of 12 unique Months created from Dec 2010 to Nov 2011 li ul h4 style color Navy text align left Sum Total of Items Purchased Spread by CohortMonth h4 h5 Inference s h5 ul li TotalMonthlyCustomers Monthly Cohort Count by customer computed li li It has nan values below the diagonal which is as expected li ul h4 style color Navy text align left Cohort Monthly Customer Count Heatmap h4 ul li Easiest way to visualize cohort analysis li li Includes both data and visuals li ul h5 Inference s Drawn from Monthly Cohort Customer Counts Heatmap h5 table style width 100 text align left tr style color Crimson th style text align left th th style text align left Description th th style text align left Affected Cohorts th th style text align left Remarks th tr tr td style text align left div style word wrap break word 1 div td td style text align left div style word wrap break word First Cohort div td td style text align left div style word wrap break word December 2010 div td td style text align left div style word wrap break word 885 out of overall 4296 which is over 20 of all customers across cohorts div td tr tr td style text align left div style word wrap break word 2 div td td style text align left div style word wrap break word Last Cohort div td td style text align left div style word wrap break word November 2011 div td td style text align left div style word wrap break word 323 New Customers div td tr tr td style text align left div style word wrap break word 3 div td td style text align left div style word wrap break word High Intake Of New Customers div td td style text align left div style word wrap break word January 2011 and March 2011 div td td style text align left div style word wrap break word Greater than 400 new customers each in the cohort December 2010 excluded while computing this as existing customers vs new customer data unknown div td tr tr td style text align left div style word wrap break word 4 div td td style text align left div style word wrap break word Low Intake Of New Customers div td td style text align left div style word wrap break word July 2011 and August 2011 div td td style text align left div style word wrap break word Less than 200 new customers in each cohort div td tr tr td style text align left div style word wrap break word 5 div td td style text align left div style word wrap break word Shopping increased in October 2011 November 2011 div td td style text align left div style word wrap break word All Cohorts div td td style text align left div style word wrap break word Probably pre holiday season purchases div td tr table h4 style color Navy text align left Sum Total of Gift Items Purchased Spread by CohortMonth h4 h5 Inference s h5 ul li TotalPurchase Monthly Cohort Spend computed li li First cohort December2010 has maximum Sales as expected li li It has nan values below the diagonal which is as expected li ul h4 style color Navy Plot Bar Graph on dataframe TotalPurchase h4 h5 Inference s h5 ul li TotalPurchase Monthly Cohort Spend computed shown in bar plot li li November 2011 had maximum Cumulative Sales li ul h4 style color Navy Create Heatmap on Total Items Purchased Spread by Cohort Month h4 h5 Inference s Drawn from Total Items Purchased Spread by Cohort Month Heatmap h5 table style width 100 text align left tr style color Crimson th style text align left th th style text align left Description th th style text align left Affected Cohorts th th style text align left Remarks th tr tr td style text align left div style word wrap break word 1 div td td style text align left div style word wrap break word Maximum Items Procured Cohort div td td style text align left div style word wrap break word December 2010 div td td style text align left div style word wrap break word Four months over 450K plus purchases div td tr tr td style text align left div style word wrap break word 2 div td td style text align left div style word wrap break word Minimum Items Procured Cohort div td td style text align left div style word wrap break word Feb 2011 div td td style text align left div style word wrap break word Eight months under 64K purchases div td tr tr td style text align left div style word wrap break word 3 div td td style text align left div style word wrap break word Promising Cohort by Items div td td style text align left div style word wrap break word January 2011 div td td style text align left div style word wrap break word Greater than 50K purchases every month div td tr table h4 style color Navy text align left Cohort Mean Quantity of Gift Items Purchased Spread by CohortMonth h4 h5 Inference s Drawn from Mean Quantity of Items Purchased Spread by Cohort Month Heatmap h5 table style width 100 text align left tr style color Crimson th style text align left th th style text align left Description th th style text align left Affected Cohorts th th style text align left Remarks th tr tr td style text align left div style word wrap break word 1 div td td style text align left div style word wrap break word Maximum Mean Items Procured Cohort div td td style text align left div style word wrap break word December 2010 div td td style text align left div style word wrap break word Consistently over 12 items div td tr tr td style text align left div style word wrap break word 2 div td td style text align left div style word wrap break word Minimum Mean Items Procured Cohort div td td style text align left div style word wrap break word August 2011 div td td style text align left div style word wrap break word Consistently less than 11 items with minimum mean of 5 4 in October div td tr tr td style text align left div style word wrap break word 3 div td td style text align left div style word wrap break word Consistent Cohort by Mean Items Procured div td td style text align left div style word wrap break word December 2010 to March 2011 June 2011 div td td style text align left div style word wrap break word Atleast 9 6 mean items procured every month div td tr table h3 style color MediumBlue text align left Analyse the retention rate of customers h3 p Customer retention is a very useful metric to understand how many of all the customers are still active It gives you the percentage of active customers compared to the total number of customers p h4 style color Navy text align left Create summarization cohortGroup on CohortMonth and CohortIndex h4 h5 Inference s h5 ul li cohortGroup summarization created on CohortMonth and CohortIndex li ul h4 style color Navy text align left Compute Retention Rate h4 h5 Inference s h5 ul li Retention percentage computed across Months for cohorts li ul h4 style color Navy Create Heatmap Customer Retention Rate Spread by Cohort Month in Percentage h4 h5 Inference s Drawn from Customer Retention Rate Spread by Cohort Month in Percentage Heatmap h5 table style width 100 text align left tr style color Crimson th style text align left th th style text align left Description th th style text align left Affected Cohorts th th style text align left Remarks th tr tr td style text align left div style word wrap break word 1 div td td style text align left div style word wrap break word Maximum Retention Rate Cohort div td td style text align left div style word wrap break word December 2010 div td td style text align left div style word wrap break word Average Retention of 36 div td tr tr td style text align left div style word wrap break word 2 div td td style text align left div style word wrap break word Minimum Retention Rate Cohort div td td style text align left div style word wrap break word May 2011 div td td style text align left div style word wrap break word div Average Retention of 20 td tr tr td style text align left div style word wrap break word 3 div td td style text align left div style word wrap break word Average Retention Rate Across Cohorts div td td style text align left div style word wrap break word All Cohorts div td td style text align left div style word wrap break word 25 except for seasonal changes in October and November 2011 div td tr table h3 style color MediumBlue Data Transformation Completed h3 ul li Performed cohort analysis a cohort is a group of subjects that share a defining characteristic Observeed how a cohort behaves across time and compare it to other cohorts ul li a Created month cohorts and analyze active customers for each cohort li li b Analyze the retention rate of customers li ul li ul h3 style color MediumBlue text align left Data Modeling h3 ul li 1 Build a RFM Recency Frequency Monetary model Recency means the number of days since a customer made the last purchase Frequency is the number of purchase in a given period It could be 3 months 6 months or 1 year Monetary is the total amount of money a customer spent in that given period Therefore big spenders will be differentiated among other customers such as MVP Minimum Viable Product or VIP li li 2 Calculate RFM metrics li li 3 Build RFM Segments Give recency frequency and monetary scores individually by dividing them into quartiles ul li a Combine three ratings to get a RFM segment as strings li li b Get the RFM score by adding up the three ratings li li c Analyze the RFM segments by summarizing them and comment on the findings li ul li ul p b Note b Rate recency for customer who has been active more recently higher than the less recent customer because each company wants its customers to be recent p p b Note b Rate frequency and monetary higher because the company wants the customer to visit more often and spend more money p h3 style color MediumBlue text align left Build a RFM Recency Frequency Monetary model h3 h3 style color MediumBlue text align left RFM Analysis h3 p b RFM analysis b is a customer segmentation technique that uses past purchase behavior to divide customers into groups RFM helps divide customers into various categories or clusters to identify customers who are more likely to respond to promotions and also for future personalization services p table style width 100 text align left tr style color Crimson th style text align left Item th th style text align left Abbreviation th th style text align left Definition th tr tr td style text align left Recency td td style text align left R td td style text align left Days since last customer transaction td tr tr td style text align left Frequency td td style text align left F td td style text align left Number of transactions in the last 12 months td tr tr td style text align left Monetary td td style text align left M td td style text align left Total spend in the last 12 months td tr table h4 style color Navy text align left Benefits of RFM analysis h4 ul li Increased customer retention li li Increased response rate li li Increased conversion rate li li Increased revenue li ul p To perform RFM analysis we divide customers into four equal groups according to the distribution of values for recency frequency and monetary value Four equal groups across three variables create 64 4x4x4 different customer segments which is a manageable number p p For example let s look at a customer who p ul li is within the group who purchased most recently R 4 li li is within the group who purchased most quantity F 4 li li is within the group who spent the most M 4 li li Increased revenue li ul p This customer belongs to RFM segment 4 4 4 Best Customer R 4 F 4 M 4 p h4 style color Navy text align left Copy EDA completed Data dataframe into RFMData for RFM Analysis h4 h5 Inference s h5 ul li RFMData dataframe has 375665 rows of data spread across 9 columns which matches the data dataframe li ul h4 style color Navy Perform head operation on RFMData to check data integrity h4 h5 Inference s h5 ul li First 5 rows of RFMData checked and passed data quality check li ul h3 style color MediumBlue text align left Recency h3 h4 style color Navy text align left Create a hypothetical snapshot currentDate data as if we re doing analysis recently h4 h5 Inference s h5 ul li Variable CurrentDate computed as 1st December 2011 Hypothetical Snapshot Date li ul h4 style color Navy Compute Recent Purchase Date column to have Date part alone of Invoice date h4 h5 Inference s h5 ul li RecentPurchaseDate column created and data quality check successful on first 5 rows validation li ul h4 style color Navy text align left Compute Recency by Grouping RFMData on CustomerID and Maximum of RecentPurchaseDate h4 h5 Inference s h5 ul li Recency Dataframe Computed with CustomerID and RecentPurchaseDate li li Data quality check successful on first 5 rows validation li ul h4 style color Navy text align left Add column CurrentDate column to Recency Dataframe h4 h5 Inference s h5 ul li CurrentDate column added to Recency Dataframe li li Data quality check successful on first 5 rows validation li ul h4 style color Navy text align left Compute Recency Column as difference between current date and RecentPurchaseDate h4 h5 Inference s h5 ul li Recency column computed and added to Recency Dataframe li li Data quality check successful on first 5 rows validation li ul h4 style color Navy text align left Data Clean Up Drop Columns RecentPurchaseDate and CurrentDate h4 h5 Inference s h5 ul li RecentPurchaseDate and CurrentDate columns dropped from recency dataframe li li Data quality check successful on first 5 rows validation li ul h4 style color Navy text align left Data Integrity Shape Check on Recency Dataframe h4 h5 Inference s h5 ul li Recency dataframe has 2 columns with 4296 rows 1 pertaining to each customer ID li li Data Integrity shape test successful on recency dataframe li ul h3 style color MediumBlue text align left Frequency h3 p b Frequency b is about the number of purchase in a given period It could be 3 months 6 months or 1 year So we can understand this value as for how often or how many a customer used the product of a company The bigger the value is the more engaged the customers are p h4 style color Navy text align left Compute Frequency Dataframe grouping on Customer ID by count of InvoiceNo h4 h5 Inference s h5 ul li frequency Dataframe computed and it has 2 columns CustomerID and Frequency li li Data quality check successful on first 5 rows validation li ul h4 style color Navy Data Shape Quality Check on Frequency Dataframe h4 h5 Inference s h5 ul li frequency dataframe has 2 columns with 4296 rows 1 pertaining to each customer ID li li Data Integrity shape test successful on frequency dataframe li ul h3 style color MediumBlue text align left Monetary h3 p b Monetary b is the total amount of money a customer spent in that given period Therefore big spenders will be differentiated with other customers such as MVP or VIP p h4 style color Navy Compute Monetary Value Dataframe grouping on Customer ID by sum of TotalCost h4 h5 Inference s h5 ul li monetary Dataframe computed and it has 2 columns CustomerID and Monetary li li Data quality check successful on first 5 rows validation li ul h4 style color Navy Data Shape Quality Check on monetary Dataframe h4 h5 Inference s h5 ul li monetary dataframe has 2 columns with 4296 rows 1 pertaining to each customer ID li li Data Integrity shape test successful on monetary dataframe li ul h3 style color MediumBlue text align left Build RFM Table h3 h4 style color Navy text align left Combine Recency Frequency and Monetary into aggregated RFMModel dataframe h4 h5 Inference s h5 ul li RFMModel Dataframe computed and it has 4 columns CustomerID Recency Frequency and Monetary li li Data quality check successful on first 5 rows validation li ul h4 style color Navy Data Shape Quality Check on RFMModel Dataframe h4 h5 Inference s h5 ul li RFMModel dataframe has 4 columns with 4296 rows 1 pertaining to each customer ID li li Data Integrity shape test successful on RFMModel dataframe li ul h4 style color Navy Data Integrity Check on Unique Customers on Baselined Data dataframe h4 h5 Inference s h5 ul li Data Dataframe had 4296 unique customers which matches the RFMModel Dataframe size li ul h4 style color Navy text align left Set Customer ID as index for RFMModel dataframe h4 h3 style color MediumBlue text align left Validate RFM Table Integrity from Customer ID R F am M perspectives h3 h4 style color Navy text align left Match RFMData Customer ID and RFMModel Index and display the head of the comparison result in RFMData h4 h5 Inference s h5 ul li First 5 Matched rows of RFMData Customer ID and RFMModel Index displayed from dataframe RFMData li li Data quality check successful on first 5 rows validation li ul h4 style color Navy text align left Validate Recency for first Customer ID h4 h5 Inference s h5 ul li Validation of Recency computation between RFMData and RFMModel was successful and return positive boolean output for first CustomerID on RFMModel dataframe li ul h4 style color Navy RFM Recency Frequency Monetary model RFMModel created h4 h3 style color MediumBlue text align left Build RFM Segments Give recency frequency and monetary scores individually by dividing them into quartiles h3 ul li a Combine three ratings to get a RFM segment as strings li li b Get the RFM score by adding up the three ratings li li c Analyze the RFM segments by summarizing them and comment on the findings li ul p Note Rate recency for customer who has been active more recently higher than the less recent customer because each company wants its customers to be recent p p Note Rate frequency and monetary higher because the company wants the customer to visit more often and spend more money p h4 style color Navy text align left Create RFM Score for R F and M on a scale of 1 to 4 and concatenate as string to assign Customer Segment h4 h4 style color Navy text align left Create Quartiles Dictionary for RFM h4 h5 Inference s h5 ul li Quantiles Dictionary List created for Recency Frequency Monetary for 25th 50th and 75th percentile li ul h4 style color Navy text align left Create Quantiles Dataframe for RFM h4 h5 Inference s h5 ul li RFM Quantile Dataframe computed li li Data quality check successful on all rows validation li li Significant Outliers found in Recency Frequency and Monetary beyond 75th percentile li ul h4 style color Navy text align left Plot Recency Quantiles Distribution h4 h5 Inference s h5 ul li Recency Quantile Distribution Boxplot shows outliers beyond 75th percentile li ul h4 style color Crimson text align left Plot Frequency Quantiles Distribution h4 h5 Inference s h5 ul li Frequency Quantile Distribution Boxplot shows outliers beyond 75th percentile li ul h4 style color Navy text align left Monetary Quantiles Distribution h4 h5 Inference s h5 ul li Monetary Quantile Distribution Boxplot shows outliers beyond 75th percentile li ul h4 style color Navy text align left Plot Quantiles Distribution Bar Spread 0 25 50 75 h4 h5 Inference s h5 ul li Distribution RFM sub plot to show the distribution across first 3 quantile splits li li Top quantile not plotted as it had outliers and plot would have miniscule values for first 3 quantiles li ul h4 style color Navy text align left RFM Quantile Summary h4 table style width 100 text align left tr style color Purple th style text align center RFM Type th th style text align center 0th Percentile th th style text align center 25th Percentile th th style text align center 50th Percentile th th style text align center 75th Percentile th th style text align center 100th Percentile th th style text align center Outliers Comments th tr tr td style text align center div style word wrap break word Recency div td td style text align right div style word wrap break word 1 div td td style text align right div style word wrap break word 16 div td td style text align right div style word wrap break word 50 div td td style text align right div style word wrap break word 144 50 div td td style text align right div style word wrap break word 365 div td td style text align right div style word wrap break word Found Above 75th Percentile div td tr tr td style text align center div style word wrap break word Frequency div td td style text align right div style word wrap break word 1 div td td style text align right div style word wrap break word 17 div td td style text align right div style word wrap break word 40 div td td style text align right div style word wrap break word 97 div td td style text align right div style word wrap break word 7288 div td td style text align right div style word wrap break word Found Above 75th Percentile div td tr tr td style text align center div style word wrap break word Monetary div td td style text align right div style word wrap break word 2 90 div td td style text align right div style word wrap break word 303 90 div td td style text align right div style word wrap break word 653 02 div td td style text align right div style word wrap break word 1594 62 div td td style text align right div style word wrap break word 268478 div td td style text align right div style word wrap break word Found Above 75th Percentile div td tr tr table h4 style color Navy text align left Copy RFMModel dataframe into RFMSegment for RFM Segment Table h4 h5 Inference s h5 ul li RFM Segment Dataframe created from RFMModel Dataframe li li RFM Segment Dataframe has 4296 rows and 3 columns which match the RFMModeldataframe li ul h4 style color Navy text align left Perform head operation on RFMSegment to check data integrity h4 h5 Inference s h5 ul li RFMSegment data quality checked validating first 5 rows of data li ul h4 style color Navy text align left Compute R F and M Quantiles for each Customer ID h4 ul li Process of calculating percentiles ul li 1 Sort customers based on that metric li li 2 Break customers into a pre defined number of groups of equal size li li 3 Assign a label to each group li ul li ul h4 style color Navy text align left Compute R Quantile h4 ul li Highest score to the best metric best is not always highest e g recency li li In this case the label is inverse the more recent the customer the better li ul h5 Inference s h5 ul li R quantile segment Values created in RFMSegment Dataframe li li RFMSegment data quality checked validating first 5 rows of data li ul h4 style color Navy text align left Compute F Quantile h4 h5 Inference s h5 ul li F quantile segment Values created in RFMSegment Dataframe li li RFMSegment data quality checked validating first 5 rows of data li ul h4 style color Navy text align left Compute M Quantile h4 h5 Inference s h5 ul li M quantile segment Values created in RFMSegment Dataframe li li RFMSegment data quality checked validating first 5 rows of data li ul h4 style color Navy text align left Build RFM Segment and RFM Score h4 ul li Concatenate RFM quartile values to RFM Segment li li Sum RFM quartiles values to RFM Score li ul h5 Inference s h5 ul li RFM Segments are created li li RFMSegment data quality checked validating first 5 rows of data li li b Best Recency score b 4 li li b Best Frequency score b 4 li li b Best Monetary score b 4 li li b Best RFM Segment b 444 li li b Best RFM Score b 12 li ul h4 style color Navy text align left Print RFM Unique String Values h4 h5 Inference s h5 ul li 61 unique RFM Segment Values Created based on RFM values li ul h4 style color Navy text align left Validate RFMSegment Information h4 h5 Inference s h5 ul li RFMSegment has 8 columns of size 4296 number of Unique Customer IDs li li Recency Frequency are Integer values while Monetary is a float value li li R Quantile F Quantile and M Quantile are Integer values li li RFM Segment is a string object li li RFM Score is a integer object li ul h4 style color Navy text align left Reset the index of RFMSegment Dataframe h4 h5 Inference s h5 ul li Column size increased from 8 to 9 for the same 4296 rows li li Lets check head operation to validate data integrity li ul h4 style color Navy Data Integrity Check on RFMSegment h4 h5 Inference s h5 ul li RFMSegment data quality checked validating first 5 rows of data li li Index became numeric and CustomerID became a column li ul h4 style color Navy text align left Below is a table with key RFM segments h4 table style width 100 text align left tr style color Crimson th style text align left Customer Segment th th style text align left RFM Segment th th style text align left Criteria th th style text align left Marketing th tr tr td style text align left div style word wrap break word Best Customers div td td style text align left div style word wrap break word 444 div td td style text align left div style word wrap break word Recency Highest Frequency Highest Monetary Value Highest div td td style text align left div style word wrap break word No price incentives new products and loyalty program div td tr tr td style text align left div style word wrap break word Churned Best Customer div td td style text align left div style word wrap break word 144 244 div td td style text align left div style word wrap break word Recency Below Median Frequency Highest Monetary Value Highest div td td style text align left div style word wrap break word Incentivise via price to buy in near future and also frequently new products and loyalty program div td tr tr td style text align left div style word wrap break word Churned Frequent Customer div td td style text align left div style word wrap break word 131 132 141 142 231 232 241 242 div td td style text align left div style word wrap break word Recency Below Median Frequency Below Median Monetary Value Above Median div td td style text align left div style word wrap break word Incentivise via price to buy in near future and also frequently new economy products and loyalty program div td tr tr td style text align left div style word wrap break word Churned Low Spending Infrequent Customer div td td style text align left div style word wrap break word 111 112 121 122 211 212 221 222 div td td style text align left div style word wrap break word Recency Below Median Frequency Below Median Monetary Value Below Median div td td style text align left div style word wrap break word Limited campaign to buy new economy products with price incentives check casually on loyalty program interest div td tr tr td style text align left div style word wrap break word Churned Loyal Customer div td td style text align left div style word wrap break word 133 134 143 233 234 243 div td td style text align left div style word wrap break word Recency Below Median Frequency Above Median Monetary Value Above Median div td td style text align left div style word wrap break word Focus on Loyalty Program Incentivise to Buy div td tr tr td style text align left div style word wrap break word Churned Medium High Spender div td td style text align left div style word wrap break word 113 114 123 124 213 214 223 224 div td td style text align left div style word wrap break word Recency Below Median Frequency Below Median Monetary Value Above Median div td td style text align left div style word wrap break word Focus on Loyalty Program Incentivise to Buy Again with new products div td tr tr td style text align left div style word wrap break word Inactive Best Customer div td td style text align left div style word wrap break word 344 div td td style text align left div style word wrap break word Recency 3 Frequency Highest Monetary Value Highest div td td style text align left div style word wrap break word No price incentives new products and loyalty program div td tr tr td style text align left div style word wrap break word Low Spending Inactive Customer div td td style text align left div style word wrap break word 311 312 321 322 div td td style text align left div style word wrap break word Recency Above Median Frequency Below Median Monetary Value Below Median div td td style text align left div style word wrap break word High price incentives new products and loyalty program div td tr tr td style text align left div style word wrap break word Low Spending Active Loyal Customer div td td style text align left div style word wrap break word 431 432 441 442 div td td style text align left div style word wrap break word Recency Highest Frequency Above Median Monetary Value Below Median div td td style text align left div style word wrap break word High price incentives market niche products in economy segment increasing spend div td tr tr td style text align left div style word wrap break word Low Spending Inactive Loyal Customer div td td style text align left div style word wrap break word 331 332 341 342 div td td style text align left div style word wrap break word Recency 3 Frequency Above Median Monetary Value Below Median div td td style text align left div style word wrap break word High price incentives market niche products in economy segment increasing spend div td tr tr td style text align left div style word wrap break word Low Spending New Customer div td td style text align left div style word wrap break word 411 412 421 422 div td td style text align left div style word wrap break word Recency Highest Frequency Below Median Monetary Value Below Median div td td style text align left div style word wrap break word High price incentives market niche products in economy segment increasing spend try loyalty program div td tr tr td style text align left div style word wrap break word Medium High Spending Active Customer div td td style text align left div style word wrap break word 313 314 323 324 413 414 423 424 div td td style text align left div style word wrap break word Recency Above Median Frequency Below Median Monetary Value Above Median div td td style text align left div style word wrap break word Low price incentives market niche products in premium segment increasing spend go for loyalty program div td tr tr td style text align left div style word wrap break word Medium High Spending Active Loyal Customer div td td style text align left div style word wrap break word 333 334 343 433 434 443 div td td style text align left div style word wrap break word Recency Above Median Frequency Above Median Monetary Value Above Median div td td style text align left div style word wrap break word Low price incentives market niche products in premium segment market associated products based on previous items surfed purchased div td tr table h4 style color Navy text align left Create segment customer function on RFMtable created above to map RFM segments to customer segments h4 h5 Inference s h5 ul li 13 unique customer segments mapped li li Churned Low Spending Infrequent Customer segment had 1233 of 4296 customers li li Low Spending Active Loyal Customer segment had 91 of 4296 customers li ul h4 style color Navy text align left Check head of RFMSegment Dataframe for Data Integrity h4 h5 Inference s h5 ul li RFMSegment data quality checked validating first 5 rows of data li ul h4 style color Navy Check the distribution of CustomerSegment h4 h5 Inference s h5 ul li Churned Low Spending Infrequent Customer segment has 28 7 highest li li Low Spending Active Loyal Customer segment has 2 1 lowest li ul h4 style color Navy Random Sample on RFMSegment to check data h4 h5 Inference s h5 ul li CustomerSegment sample showed a variety of RFM scores and CustomerSegments showing up data quality check verified and passed li ul h4 style color Navy Grouping by RFM Score for Market Campaigns To be used in visualization h4 h5 Inference s h5 ul li MarketSegment field imputed li li On an average the 398 platinum customers spent 9484 while the 1259 bronze customers spent on an average 264 showing a huge disparity between the High Spending and the low spending customers li li On an average the 398 platinum customers visited 7 days ago and did 363 transactions against average of 190 days and only 15 transactions per person for the 1259 bronze customers li ul h4 style color Navy text align left Customer Segment Spread by Categories h4 h5 Inference s h5 ul li Data Visualization shows 1233 Churned Low Spending Infrequent Customers 29 of customer base li li Data Visualization shows 619 Medium High Spending Active Loyal Customers 14 of customer base li li Data Visualization shows 398 Best Customers 9 of customer base li li Data Visualization shows 382 customers across Churned Inactive Best Customers 9 of customer base li li Data Visualization shows 354 Churned Loyal Customer 8 of customer base li ul h3 style color MediumBlue text align left Data Modeling Completed For h3 ul li 1 Building a RFM Recency Frequency Monetary model li li 2 Calculating RFM metrics li li 3 Building RFM Segments Giving recency frequency and monetary scores individually by dividing them into quartiles ul li a Combinining three ratings to get a RFM segment as strings li li b Getting the RFM score by adding up the three ratings li li c Analyzing the RFM segments by summarizing them and comment on the findings li ul li ul h3 style color MediumBlue text align left Data Modeling h3 ul li 1 Create clusters using k means clustering algorithm ul li a Prepare the data for the algorithm If the data is asymmetrically distributed manage the skewness with appropriate transformation Standardize the data li li b Decide the optimum number of clusters to be formed li li c Analyze these clusters and comment on the results li ul li ul h3 style color MediumBlue text align left Create clusters using k means clustering algorithm h3 h4 style color Navy text align left Prepare the data for the algorithm If the data is asymmetrically distributed manage the skewness with appropriate transformation Standardize the data h4 h5 Inference s h5 ul li Data Visualization shows skewness for Recency Frequency and Monetary li li Let s check for negative values before doing log transformation li ul h4 style color Navy text align left Check Description of Dataframe RFMModel to identify negative values h4 h5 Inference s h5 ul li No negative values proceed with log transformation li ul h4 style color Navy text align left Log Transformation of RFMModel and Scaling the Transformed Log Model into Scaled Model RFMModelScaled h4 h5 Inference s h5 ul li Log Transformation completed li li Scaled Output stored in dataframe RFMModelScaled li li First 5 values of RFMModelScaled checked and passed data quality check li ul h4 style color Navy text align left Revalidate Distribution Subplot to check data skewness after log transformation and scaling h4 h5 Inference s h5 ul li Distribution seems to follow a normal pattern for Frequency and Monetary li li Recency shows mild skewness which we will ignore for the moment li ul h4 style color Navy text align left Decide the optimum number of clusters to be formed using Kmeans h4 h4 style color Navy text align left Compute Within Cluster Sum of Squares WCSS Error through Elbow Method h4 h5 Inferences h5 ul li WCSS scores computed for clusters 1 to 13 li li 4 or 5 would be a good number considering the WCSS error tapers down after this li li Let s plot WCSS elbow graph to check our inference li ul h4 style color Navy text align left Plot WCSS Elbow Graph from computed WCSS Inertia Dataframe WCSSKmeansOut h4 h5 Inference s based on WCSS Elbow Graph h5 ul li Elbow graph WCSS Line starts smoothening from cluster 4 li li Lets validate with Silhouette score a measure of how similar an object is to its own cluster cohesion compared to other clusters separation The silhouette ranges from 1 to 1 where a high value indicates that the object is well matched to its own cluster and poorly matched to neighboring clusters li ul h4 style color Navy text align left Validate silhouette Score h4 h5 Inference s h5 ul li Data Visualization shows Highest Silhouette score value is seen for cluster 4 li li Lets confirm it once by looking at underlying scores li ul h4 style color Navy text align left Check Silhouette score Dataframe to Validate Cluster with maximum score h4 h5 Inference s h5 ul li Cluster 4 has best Silhouette score with 0 3 li li Lets plot KMeans with 4 clusters li ul h4 style color Navy text align left Decide the optimum number of clusters to be formed as 4 h4 h4 style color Navy text align left Build KMeans Model with 4 Clusters and fix random state as 1 to ensure no variation during rerun h4 h5 Inference s h5 ul li KMeans model is built on 4 clusters and Cluster Labels are generated li ul h4 style color Navy text align left Print the KMeans Model h4 h5 Inference s h5 ul li KMeans Model is built with 4 clusters and we have used random state 1 li ul p KMeans algorithm auto copy x True init k means max iter 300 n clusters 4 n init 10 n jobs None precompute distances auto random state 1 tol 0 0001 verbose 0 p h4 style color Navy text align left Validate if of entries cluster label array matches RFMSegment dataframe size in terms of rows should be equal to count of customer IDs h4 h5 Inference s h5 ul li Validation of Data Integrity b successful b between clusterLabels and RFMSegment li li 4296 was the number of rows returned for each which is correct and equal to unique Customer ID s li ul h4 style color Navy text align left Build ClusterData Table h4 h5 Inference s h5 ul li ClusterData Table Built from RFMSegment with Cluster column getting added li li Data Quality Check Validated Fine while verifying the first few rows li ul h4 style color Navy text align left Check Shape of Dataframe ClusterData h4 h5 Inference s h5 ul li ClusterData Table Bhas 4296 rows equal to unique customer ID s and has 12 columns li li Data Quality Check Validated Fine while verifying the first few rows for 12 columns in previous step li ul h4 style color Navy text align left Identify Split of customer ID s by Cluster h4 h5 Inferences h5 ul li ClusterDataCount Split Computed li li Four clusters created with sizes equal to ul li Cluster 0 b 838 b li li Cluster 1 b 1206 b li li Cluster 2 b 963 b li li Cluster 3 b 1289 b li ul li ul h4 style color Navy text align left Create BoxPlot on Cluster Count Spread h4 h5 Inference s h5 ul li ClusterData Plot Summary of Records in Four created clusters by KMeans algorithm are ul li Cluster 0 b 838 b li li Cluster 1 b 1206 b li li Cluster 2 b 963 b li li Cluster 3 b 1289 b li ul li ul h4 style color Navy text align left Sample the Cluster Table data to check correctness h4 h5 Inference s h5 ul li Sample Data validated fine and gave some intersting insights ul li Cluster Data Sample has records across clusters and segments li li Cluster 0 sample has b No customers b li li Cluster 1 sample has b Bronze customers b li li Cluster 2 sample has b Gold customers b li li Cluster 3 sample has b Gold and Silver customers b li ul li ul h4 style color Navy text align left Analyze these clusters and comment on the results h4 h4 style color Navy text align left Sample the Cluster Table data for Cluster 3 h4 h5 Inference s h5 ul li Cluster 3 sample has b Gold Silver and Bronze customers b li li RFM Score for this cluster sample varied from value of 5 Bronze to 10 Gold li li Recency Frequency and Monetary varied from 1 to 4 considering minimum RFMScore for the sample was 5 below median value li li Churned customers Recency Infrequent customers Frequency and Low Spending customers Monetary were all spotted in the sample li li Medium High Spending Active Loyal Customers Gold were all in the cluster 3 sample mix li ul h4 style color Navy text align left Sample the Cluster Table data for Cluster 2 h4 h5 Inference s h5 ul li Cluster 2 sample has b Gold and Platinum customers b Elite Cluster li li The RFM scores are all 10 and higher in the sampler and this cluster would account for maximum monetary Sales and also account for most frequent and recent transactions li li Inactive and Churned Best Customers also made the sample mix under Gold Category li ul h4 style color Navy text align left Sample the Cluster Table data for Cluster 1 h4 h5 Inference s h5 ul li Cluster 1 sample has b Bronze customers b li li RFM Score is 5 or lower in the sample li li Sample had mostly churned customers or Low Spending Inactive Customers li li Monetary capitalization of this cluster is very low of this cluster is very low li ul h4 style color Navy text align left Sample the Cluster Table data for Cluster 0 h4 h5 Inference s h5 ul li Cluster 0 sample has b Gold and Silver customers b li li RFM Scores are above the median of 6 with sample values till 10 li li Cluster accounts for the frequent customers with all samples above median value of 2 and the recency is also above median value for this cluster while the monetary value of the cluster varies from median value of 2 to above median value of 3 li li Based on sample this cluster can be targeted with new niche economy products for improving market capitalization li ul h4 style color Navy text align left Scatter Plot h4 p These will help us visualize the division of customers into different segments based on the RFM atributes p h5 Inference s h5 ul li Centroids and distribution seem even for RF and RM Plots li li RF and RM Plot has best values for cluster 2 and the worst values for cluster 1 li li RF and RM Plot has lower recency values for cluster 3 than cluster 2 li li RF and RM Plot has lower frequency values for cluster 0 than cluster 2 li li Centroids for cluster 0 and 3 are closer for FM Plot and distribution seem well distributed except for segments 0 and 3 which overlap li li FM Plot has lowest values for cluster 1 medium for clusters 0 and 3 which overlap and high values for cluster 2 li ul h4 style color Navy text align left Snake Plot h4 ul li Market research technique to compare different segments li li Visual representation of each segment s attributes li li Need to first normalize data center scale li li Plot each cluster s average normalized values of each attribute li ul p To plot this we should have normalized data distribution and all the attributes in a single column We will use pandas melt facility on RFMModelScaled to achieve that p h4 style color Navy text align left Dataframe Melt h4 h5 Inference s h5 ul li Single Metric computed each for R F amd M for customer li li New variable Metric li li Data quality check validated okay lets check the shape li ul h4 style color Navy text align left Check shape of RFMModelScaledMelt dataframe h4 h5 Inference s h5 ul li 12888 rows of data with 4 columns is the shape li li Each of the 4296 CustomerID s now has 3 metric values one for Recency Frequency and Monetary but we have only 4 columns li li Melt is successful let s do snake plot visualization li ul h4 style color Navy text align left RFM Snake Plot Visualization h4 h5 Inference s h5 ul li Snakeplot executed to identify RFM attributes for each cluster and will for basis for market capitalization by executing specific focused campaigns for the cluster to improve Sales and loyalty li li b Cluster 0 b ul li Cluster 0 has negative values closer to 0 on F and M and negative values farther away on R from 0 implying recency above median with the other 2 values varying from 1 to 4 li li It has a small population of low spending customers with recency 3 who are under bronze category with RFM score less than 6 major share of silver customers with good mix of active and loyal customers who have various levels of frequency and monetary and a gold share of gold customers with high recency loyal customers li li Strategy for this cluster is to lure customers with new economy products with discounts and good recommendations to keep the transaction count high and plan for loyalty programs li li Exciting low spend category who have shopped recently li ul li li b Cluster 1 b ul li Cluster 1 has negative values significantly further away from 0 for F further away from 0 for M and high positive values for R implying all these 3 values are below the median values for R F and M mostly li li This is understandable as this cluster has mostly customers with RFM scores below median score of 6 and a few just over the median Most of these customers in this cluster are churned low spending customers churned loyal customers churned medium spenders and inactive not so frequent low spending customers li li It also has a few new customers who are spending lower and have lower frequency li li This is the cluster which need be prioritized for campaigns as a tactical approach as the monetary capitalization and the RFM analysis show this cluster can have minimum campaigns loyalty program or encouraging spend here may not get much traction li ul li li b Cluster 2 b ul li Cluster 2 has high negative values for R and high positive values for F and highest positive values for M implying this is the cluster with high RFM and caters to all platinum and gold with maximum sales most recent and most frequent li li This cluster accounts for more than 6 million sales in the 1 year and for this cluster the customers need to be marketed with new niche gift premium products which appeal to the sensibilities to ensure consistent monetary capitalization li li No price discounts need to be planned for this cluster campaign li ul li li b Cluster 3 b ul li Cluster 3 has positive values closer to 0 for F and M and positive values slightly further from 0 for R indicating this is the cluster with RFM scores above median and has a combination of Bronze Silver and Gold and is our target cluster to improve Sales and Loyalty li li This cluster needs to be looked at closely and more than 1 strategy devised to improve frequency where applicable improve spend for new customers and target churned loyal customers and churned medium to high spenders li li Exciting sector for marketing as it has a plethora of opportunities and needs a comprehensive SWOT analysis to improve capitalization and see how these customers can be moved up the value chain li ul li ul h4 style color Navy text align left Heat Map h4 p Heat map to visualize the relative importance of each attributes across 4 clusters p p The farther a ratio is from 0 the more important that attribute is for a segment relative to the total population p h5 Inference s h5 ul li AttributeInterDependence computed for each cluster for Recency Frequency and Monetary li li Cluster 2 alone has high values on Frequency and Monetary Interdependence li li Cluster 0 and Cluster 2 have high negative values in Recency li li Cluster 0 and Cluster 1 have high negative values in Monetary li li Let s plot heatmap visualization to get more insights li ul h4 style color Navy text align left Clusterwise Related Dependence Heatmap h4 h5 Inference s h5 ul li Heatmap executed between cluster Mean and Population Mean across Metrics of R F and M to identify the interdependence li li b Cluster 0 b ul li Highest Negative Value of 0 83 for R b Insight is most recent b li li Medium Negative Value of 0 5 for F b Insight is not so frequent b li li Medium to High Negative Value of 0 67 for M b Insight is low spending customer base b li li High amount of silver customers and mix of low monetary gold customers is due to this li ul li b Cluster 1 b ul li Highest Positive Value of 0 94 for R b Insight is least recent and churned b li li Highest Negative Value of 0 86 for F across clusters b Insight is least frequent and least active b li li Highest Negative Value of 0 87 for M across clusters b Insight is low spending customer base b li li Highest amount of churned customers bronze and small mix of low spending new customers with RFM close to median value of 6 silver is due to this li ul li b Cluster 2 b ul li High Negative Value of 0 8 for R b Insight is most recent with few cases above median b li li Highest Positive Value of 1 92 for F b Insight is most active customer base b li li Highest Positive Value of 2 23 for M b Insight is maximum spending customer base b li li Highest amount of best customers Platinum with few infrequent best customers and few churned best customers and medium high spending loyal active customers make this segment Gold li ul li b Cluster 3 b ul li Medium Positive Value of 0 26 for R b Insight is near the median values and not recent b li li Medium Negative Value of 0 31 for F b Insight is not so frequent with values near the median b li li Medium Negative Value of 0 42 for M b Insight is low to medium spending customer base with values mostly over median varying between 2 and 3 b li li High amount of silver customers and mix of low monetary gold customers is due to this This group will have cross over of some bronze customers if Monetary value is lower as the other 2 parameters are lower li ul li ul h4 style color Navy text align left Check Customer Segment Spread for Cluster 0 h4 h5 Inference s h5 ul li Good volume of Medium High Spending Active Loyal Customer li li Good volume of recent Low Spending New Customer and recent Low Spending Inactive Customer li li Good volume of Medium High Spending Active Customer li li Good volume of Low Spending Active Loyal Customer li ul h4 style color Navy text align left Check Customer Segment Spread for Cluster 1 h4 h5 Inference s h5 ul li Maximum volume of Churned Low Spending Infrequent Customer li li Good volume of Low Spending Inactive Customer li ul h4 style color Navy text align left Check Customer Segment Spread for Cluster 2 h4 h5 Inference s h5 ul li Maximum volume of Best customers li li Maximum volume of Inactive Best customers li li High volume of Medium High Spending Active Loyal Customer li ul h4 style color Navy text align left Check Customer Segment Spread for Cluster 3 h4 h5 Inference s h5 ul li Maximum volume of Churned Loyal Customer li li Good volume of Churned Low Spending Infrequent Customer li li Good volume of Churned Medium High Spender li li Good volume of Churned Frequent Customer li li Good volume of Medium High Spending Active Loyal Customer li li Notable volume of Churned Best Customer li ul h3 style color MediumBlue text align left Data Modeling Completed for h3 ul li 1 Creating clusters using k means clustering algorithm ul li a Preparing the data for the algorithm If the data is asymmetrically distributed manage the skewness with appropriate transformation Standardize the data li li b Deciding the optimum number of clusters to be formed li li c Analyzing these clusters and comment on the results li ul li ul h3 style color MediumBlue text align left Data Reporting h3 ul li 1 Create a dashboard in tableau by choosing appropriate chart types and metrics useful for the business The dashboard must entail the following ul li a Country wise analysis to demonstrate average spend Use a bar chart to show the monthly figures li li b Bar graph of top 15 products which are mostly ordered by the users to show the number of products sold li li c Bar graph to show the count of orders vs hours throughout the day li li d Plot the distribution of RFM values using histogram and frequency charts li li e Plot error cost vs number of clusters selected li li f Visualize to compare the RFM values of the clusters using heatmap li ul li ul h4 style color Navy text align left Export Dataframes Data and ClusterData to Excel h4 h4 style color Navy text align left Tableau Visualization h4 a href https public tableau com views OnlineRetailRFMAnalysis RishikeshSreedhar SalesDash language en display count y publish yes origin viz share link Tableau Visualization Dashboards a h3 style color MediumBlue text align left Data Reporting Completed h3 ul li 1 Created a dashboard in tableau by choosing appropriate chart types and metrics useful for the business The dashboard must entail the following ul li a Country wise analysis to demonstrate average spend Used a bar chart to show the monthly figures b Check Sales Dash filtering on Month and Region and use reset filters to reset b li li b Bar graph of top 15 products which are mostly ordered by the users to show the number of products sold b Check Sales Dash filtering on Month and Region and use parameter top N and use reset filters to reset filters no reset on parameter b li li c Bar graph to show the count of orders vs hours throughout the day b Check Sales Dash filtering on Month and Region and use reset filters to reset b li li d Plot the distribution of RFM values using histogram and frequency charts b Check Cluster Dash filtering on Cluster and use reset filters to reset b li li e Plot error cost vs number of clusters selected b Check Cluster Dash filtering on Cluster and use reset filters to reset b li li f Visualize to compare the RFM values of the clusters using heatmap b Check Customer Dash filtering on CustomerID and use reset filters to reset b li ul li ul  numpy for matehmatical computations pandas for data computations warnings to supress second and subsequent repeated warnings datetime imports for date time computations json for handling json data Visualization Imports matplotlib inline StandardScaler Data Normalization Imports Kmeans cluter algorithm import Identify Silhouette score for best KMeans cluster import Supress Scientific notation in python import Display all columns of long dataframe Import input datasets Bonus Steps Import Country Dataset For Visualization in Tableau have added a Country to Country Code Mapping Check the shape of dataframe Check the shape of dataframe Set notebook mode to work in offline Use hole to create a donut like pie chart Set notebook mode to work in offline Use hole to create a donut like pie chart We don t need records with Null customer id for RFM analysis so let s remove those first title function in python to convert the character column to title case or proper case Convert CustomerID to int type Convert CustomerId to str type Create feature total cost of the transactions Count of transactions in different years Count of transactions in 2011 Outliers InterQuartile Range IQR 1 5 IQR Rule for Numeric Data Sort the data in ascending order GET Q1 and Q3 Calc IQR Calc LowerRange Calc Upper Range Set notebook mode to work in offline Use hole to create a donut like pie chart We don t need records with Quantity 0 and positive outliers which are cancelled for RFM analysis so let s remove those records Set notebook mode to work in offline Use hole to create a donut like pie chart We don t need records with UnitPrice 0 for RFM analysis so let s remove those records Set notebook mode to work in offline Use hole to create a donut like pie chart We need only 1 year of data removing data of December 2011 which has partial month data Create Dataframe dataTableau Parse Year Month of InvoiceMonth column into invoiceYear invoiceMonth columns using function obtainDateInterval Parse Year Month of CohortMonth column into cohortYear cohortMonth columns using function obtainDateInterval Calculate difference between invoiceYear and the assigned cohortYear in years for every row item Calculate difference between invoiceMonth and the assigned cohortMonth in months for every row item Set CohortIndex as diffYears 12 diffMonths 1 1 is added so that CohortIndex is never 0 if the first and subsequent transaction for customer are in same month Create Individual Months List for cohort analysis Create a groupby object MonthlyActiveCustomerGroup and pass the monthly cohort and cohort index as a list Calculate the sum of the TotalCost column Reset the index of cohort data Create a pivot Display Monthly Customer Cohort count Initialize plot figure Add a title Create the heatmap Create a groupby object TotalCostGroup and pass the monthly cohort and cohort index as a list Calculate the sum of the TotalCost column Reset the index of cohort data Create a pivot Initialize plot figure Add a title Create the heatmap Create a groupby quantityGroup object and pass the monthly cohort and cohort index as a list Calculate the average of the Quantity column Reset the index of cohort data Create a pivot Initialize plot figure Add a title Create the heatmap Count the number of unique values per customer ID Create a pivot Select the first column and store it to cohort sizes Divide the cohort count by cohort sizes along the rows Initialize inches plot figure Add a title Create the heatmap Set variable current date to this max of Invoice date in dataframe RFMData Lets create a date column RecentPurchaseDate for date part only of InvoiceDate Create column currentDate in dataframe recency Compute Recency as difference between current date and RecentPurchaseDate Data Clean Up Drop Columns RecentPurchaseDate and CurrentDate Match RFMData Customer ID and RFMModel Index and display the head of the comparison result in RFMData Check if the number difference of days from the purchase date in original record is same as shown in RFMModel RFM Quartiles Set title Set title Set title Set title RScore Function Arguments Getting Passed S Score P Recency Q quantiles dict FMScore Function Arguments Getting Passed S Score P Frequency Monetary Q quantiles dict Compute RFM Score as a String Reset the index to create customerID column Create Customer Segment Function Check head of RFMSegment Dataframe for Data Integrity Create Market Segment Function Validate Distribution Skewness using distplot subplots Set title Let s describe the table to see if there are any negative values Transform the data before K Means clustering Taking log first because normalization forces data for negative values Normalize the data for uniform averages and means in the distribution Revalidate Distribution Subplot to check data skewness after log transformation Set title Compute Within Cluster Sum of Squares WCSS Error through Elbow Method Choose range of 1 to 14 as we have 13 Customer Segments Plot WCSS Elbow Graph Optimum Cluster Validation using Silhouette Score Using 3 as lower range number as typically best score for Silhouette is obtained for 2 clusters With 13 segments selected 2 clusters is not ideal plot Silhouette graph Set title Build KMeans Model with 4 Clusters Assign the clusters as column to each customer Compute counts of CustomerIDs assigned to different clusters Sample the Cluster Table data to check data correctness Plot 2D plots of RF FM and RM Assign Cluster values to each customer in normalized dataframe Melt normalized dataframe into long form to have all metric in same column RFM Snake Plot Visualization Assign Cluster labels to RFMModelCluster table Average attributes for each cluster Calculate the population average Calculate relative importance of attributes by Export datasets with pd ExcelWriter outputPath Online Retail EDA xlsx engine xlsxwriter mode w as writer ", "id": "rishikeshsreedhar/online-retail-superstore-cohort-and-rfm-analysis", "size": "86127", "language": "python", "html_url": "https://www.kaggle.com/code/rishikeshsreedhar/online-retail-superstore-cohort-and-rfm-analysis", "git_url": "https://www.kaggle.com/code/rishikeshsreedhar/online-retail-superstore-cohort-and-rfm-analysis"}