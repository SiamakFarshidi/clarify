{"name": "biological sequence operations ", "full_name": " h1 1 BACKGROUND h3 ABC 1 2 NUCLEIC ACIDS h3 ABC 2 2 AMINO ACIDS h3 COMPLEMENTARY STRANDS IN DNA h3 REVERSE COMPLEMENT h3 STEP 1 RNA SYNTHESIS TRANSCRIPTION h3 STEP 2 PROTEIN SYNTHESIS TRANSLATION h4 CODONS h4 START STOP CODONS h4 OPEN READING FRAMES ORF h1 2 DEFINING A SEQUENCE OPERATIONS CLASS h3 SEQUENCE OPERATION CLASS h3 SQ CLASS METHODS h4 CONSTRUCTOR h4 GENERAL METHODS h4 COUNTING METHODS h4 STRAND METHODS h4 PROTEIN GENERATION METHODS h4 PATTERN IDENTIFICATION h4 GENERATING SUBSEQUENCES h3 MAPPING DICTIONAY h1 3 BASIC SEQUENCE OPERATIONS h3 DEFINING A BASIC SEQUENCE h3 CHECK ITS VALIDITY h3 SWITCH TO ITS REVERSE COMPLEMENT h3 DEFINING A DETAILED SEQUENCE h3 MAKING ANNOTATIONS h1 4 COUNTING CHARACTERS h3 NUCLEOTIDE AMINO ACID h3 DI TRINUCLEOTIDES COUNTS h3 GC CONTENT COUNTS h3 PURINES PYRIMIDINES COUNTS h1 5 DECODING DNA FOR PROTEIN GENERATION h3 OVERVIEW h3 START STOP CODONS h3 OPEN READING FRAME h3 IDEAL CASE P 0 h1 6 LOADING FILES CONTAINING SEQUENCES h3 REAL SEQUENCES h3 THE FASTA FORMAT h3 READING SEQUENCE FILES CLASS h3 read seq CLASS METHODS h1 7 RECOGNISING PATTERNS h3 PROSITE PATTERN FORMAT h3 STANDARD ABC PATTERNS h1 8 CREATING SUBSEQUENCES h3 CREATING LISTS OF SUBSEQUENCES h3 GENERATING OHE DNA FEATURES h1 9 COVID 19 PROTEIN IDENTIFICATION h3 READING DNA SEQUENCE FROM A DATABASE h3 BLAST DATABASE SEARCHING h3 USING THE NCBI API via Biopython h3 FUNCTIONAL PROTEINS OLIGOPEPTIDES h3 MANUALLY SEARCHING OTHER DATABASES h3 ANNOTATING OUR AMINO ACID SEQUENCE h1 10 SUMMARY h3 CUSTOM CLASSES h3 OVERVIEW h3 WHERE TO FROM HERE ", "stargazers_count": 0, "forks_count": 0, "description": " https images wixmp ed30a86b8c4ca887773594c2 wixmp com f 8cc1eeaa 4046 4c4a ae93 93d656f68688 deuhlxl 8e773d23 a58f 40a3 857c 704af8622e43 jpg token eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9 eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7InBhdGgiOiJcL2ZcLzhjYzFlZWFhLTQwNDYtNGM0YS1hZTkzLTkzZDY1NmY2ODY4OFwvZGV1aGx4bC04ZTc3M2QyMy1hNThmLTQwYTMtODU3Yy03MDRhZjg2MjJlNDMuanBnIn1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmZpbGUuZG93bmxvYWQiXX0 mmn4 1KfUZo hlGvKyDsIaRkLCdc4 hQEuKXcJ0FEko Kras Driven Lung Cancer nci unsplash https unsplash com photos zoFbfT0M BU b 1 span style color F55AA2 span BACKGROUND b div style color white display fill border radius 5px background color 323232 font size 220 font family Nexa letter spacing 0 5px p style padding 10px color white b 1 1 CELL INFORMATION b p div A cell is mostly composed of water a bacteria cell has a weight composition of roughly 70 water 30 b span style color 5D2ECC chemical origin span b of which b 7 are small molecules b Inc b span style color 5D2ECC amino acids span b and b span style color 5D2ECC nucleotides span b 23 b macro molecules b b proteins b lipids polysaccharides According to their internal structure they can be divided into to major categories b span style color 5D2ECC Prokaryotic span b cells have no nucleus or internal membranes b span style color 5D2ECC Eukaryotic span b cells which have a defined b nucleus b b internal membranes b and functional elements called b organelles b At a structural level all cells are surrounded by a structure called cell b span style color 5D2ECC membrane span b or b span style color 5D2ECC plasma membrane span b This b span style color 5D2ECC membrane span b is permeable to molecules that cells need to absorb from or excrete to the outside medium Within the cell we find the b cytoplasm b largely composed of water which serves as the medium for the cell div style color white display fill border radius 5px background color 323232 font size 220 font family Nexa letter spacing 0 5px p style padding 10px color white b 1 2 BIOLOGICAL SEQUENCE ALPHABETS b p div b ABC 1 2 span style color F55AA2 NUCLEIC ACIDS span b Among b span style color 5D2ECC molecules with a biological role span b we can find b span style color 5D2ECC nucleic acids span b Nucleic acids encode and express the genetic code that is kept within the cell There are two major types of b span style color 5D2ECC nucleic acids span b b DeoxyriboNucleic Acid DNA b b RiboNucleic Acid RNA b Obtainable via transcription DNA contains the information necessary to build a cell and keep it functioning In b span style color 5D2ECC eukaryotic span b cells DNA will be found in the nucleus whilst in the b span style color 5D2ECC prokaryotic span b cells it will be found in the cytoplasm b span style color 5D2ECC IUPAC span b defines the full list of nucleotides as shown in the table below with b A T G C b being the main four Another type of nucleotide list often used is IUB Ambiguity Codes http biocorp ca IUB php which we use later in the notebook as well https images wixmp ed30a86b8c4ca887773594c2 wixmp com f 8cc1eeaa 4046 4c4a ae93 93d656f68688 detobk7 b1446b53 4979 4ebd ad87 5ee7e8548736 jpg token eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9 eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7InBhdGgiOiJcL2ZcLzhjYzFlZWFhLTQwNDYtNGM0YS1hZTkzLTkzZDY1NmY2ODY4OFwvZGV0b2JrNy1iMTQ0NmI1My00OTc5LTRlYmQtYWQ4Ny01ZWU3ZTg1NDg3MzYuanBnIn1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmZpbGUuZG93bmxvYWQiXX0 p CsyGW9JeJ7FhPQMECB4Jeb2CJYy9xO FKWr Qp ug b ABC 2 2 span style color F55AA2 AMINO ACIDS span b span style color 5D2ECC Amino acids span The span style color 5D2ECC building blocks of proteins span which are b macromolecules b that perform most of the functions inside a cell Proteins have a span style color 5D2ECC broad range of functions span spanning from span style color 5D2ECC catalytic span to span style color 5D2ECC structural functions span span style color 5D2ECC Enzymes span Type of abundant proteins that promote chemical reactions and convert certain molecules into other types of molecules required for the functioning of the cell span style color 5D2ECC Carbohydrates span Serve as energy storage both for immediate and long term energy demands span style color 5D2ECC Lipids span Part of the plasma membrane doing signaling and energy storage The cell also contains other components of varying complexity Of importance b Mitochondria b the b Chloroplasts b Organelles involved in the production of energy b Ribosomes b Large and complex molecules composed of a mixture of genetic material req to assemble proteins and play a central role in the flow of genetic information https images wixmp ed30a86b8c4ca887773594c2 wixmp com f 8cc1eeaa 4046 4c4a ae93 93d656f68688 detodgt 0c9ae2b8 3e64 4876 86d9 5ff3b38de5ff jpg token eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9 eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7InBhdGgiOiJcL2ZcLzhjYzFlZWFhLTQwNDYtNGM0YS1hZTkzLTkzZDY1NmY2ODY4OFwvZGV0b2RndC0wYzlhZTJiOC0zZTY0LTQ4NzYtODZkOS01ZmYzYjM4ZGU1ZmYuanBnIn1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmZpbGUuZG93bmxvYWQiXX0 iqWr09YT1s7s1R4phtzoY2ak6M jE4VfF6MRAHKEIO8 div style color white display fill border radius 5px background color 323232 font size 220 font family Nexa letter spacing 0 5px p style padding 10px color white b 1 3 DNA STRANDS b p div b span style color F55AA2 COMPLEMENTARY STRANDS IN DNA span b DNA is a molecule composed of span style color 5D2ECC two complementary strands span that form and stick together due to the connections established between the nucleotides in both strands This is made possible by due to the chemical phenomenon where span style color 5D2ECC Adenine A span bonds only with span style color 5D2ECC Thymine T span nucleotides as a result of two hydrogen connections Similarly span style color 5D2ECC Guanine G span bonds only with span style color 5D2ECC Cytosine C span nucleotides by three hydrogen connections b span style color F55AA2 REVERSE COMPLEMENT span b This results in span style color 5D2ECC two complementary span and span style color 5D2ECC anti parallel strands span connected in opposite directions if we know the nucleotide sequence in one of the strands we can get the sequence in the opposite strand by taking the complement of its nucleotides which are also read backwards thus we have the span style color 5D2ECC reverse complement span of the other strand It has become a span style color 5D2ECC standard to describe the DNA though only one span of the strands due to this span style color 5D2ECC complementarity span using b A T G C b The existence of these two strands is essential in order to span style color 5D2ECC pass on genetic information span to new cells and span style color 5D2ECC produce proteins span div style color white display fill border radius 5px background color 323232 font size 220 font family Nexa letter spacing 0 5px p style padding 10px color white b 1 4 CENTRAL DOGMA OF MOLECULAR CELL BIOLOGY b p div The process talked about in the next section is quite complex not all aspects are competely understood a general and simplistic picture is provided below span style color 5D2ECC DNA span span style color 5D2ECC RNA span span style color 5D2ECC Proteins span are the central elements of the flow of genetic information that occurs in two steps b STEP 1 RNA SYNTHESIS span style color F55AA2 TRANSCRIPTION span b Preliminary step required to produce a b protein b The nucleotide sequence of a gene from one of the DNA strands is transcribed copied into a complementary molecule of RNA The complementarity of the genetic code allows recovering the information encoded in the original DNA sequence a process performed by the enzyme RNA polymerase Additional steps of RNA processing including stabilising elements at the end of the molecule are performed by different protein complexes After these steps which occur within the nucleus of the cell an RNA molecule b mature messenger RNA mRNA b is obtained The b mRNA b is then transported to the cytoplasm where it will be used by the cellular machine to guide the production of a protein b STEP 2 PROTEIN SYNTHESIS span style color F55AA2 TRANSLATION span b Process in which the nucleotide sequence of the mRNA is b transcribed into a chain of amino acids b forming a b polypeptide b b Proteins b are cellular entities that have either a span style color 5D2ECC Structural function span Participating in the physical definition of a cell b span style color 5D2ECC Chemical function span Being involved in chemical reactions occuring in the cell In order to function as expected a protein needs to acquire the appropriate structure this structure is often decomposed at different complexity levels The primary structure is defined by the chain of amino acids b polypeptide b consisting in part or completely of protein This process is performed by the span style color 5D2ECC ribosomes span that attach and scan the mRNA from one end to the other in groups of b nucleotide triplets b b Codons b span style color 5D2ECC CODONS span In each position of the triplet we have 1 4 nucleotides ie there are 4x4x4 64 possible triplets Codons For each codon in the mRNA sequence we have a corresponding amino acid in the b polypeptide chain b span style color 5D2ECC START STOP CODONS span Some of these codons represent significant signals that indicate the b initiation b or the b termination b of the translation process Once the ribosome detects an initiation codon it starts the formation of the amino acid chain and when it scans the stop codon it stops the translation and detaches from the mRNA molecule There are b 20 types of amino acids used to form polypeptides b for IUPAC less than the 64 possible codons therefore we have more than one codon corresponds to a type of amino acid During the translation process A type of small RNA molecule b transfer RNA tRNAs b will bring to the b ribosome b the amino acids of the corresponding type which will be complementary to the mRNA codon that is currently being scanned Each mRNA molecule can be scanned multiple times by different ribosomes giving rise to multiple copies of the polypeptide With its redundency where more than one codon encodes an amino acid the genetic code encloses a very efficient code correction mechanism that minimises the impact of errors in the nucleotide sequence occuring in DNA replication span style color 5D2ECC OPEN READING FRAMES ORF span During translation process Parsing of the mRNA sequence by the ribosome span style color 5D2ECC may start at different nucleotides span Given that a codon is composed of three nucleotides the mRNA sequence may have b 3 possible interpretations b These three ways of parsing the sequence are called span style color 5D2ECC reading frames span div style color white display fill border radius 5px background color 323232 font size 220 font family Nexa letter spacing 0 5px p style padding 10px color white b 1 5 CREATING OUR OWN SEQUENCE CLASS b p div Whilst there are wonderful libraries like span style color 5D2ECC BioPython span but it s often quite benefitial to understand the workings of the code expand on the code if a need arises This is more time consuming nevertheless it s definitely more interesting allows us to incorporate different libraries eg code bokeh code In this notebook emphasis will be placed on replicating something similar to two BioPython modules from Bio import span style color 5D2ECC SeqIO code Class for readng sequences from Bio Seq import span style color 5D2ECC Seq code Class for Sequence Operations At the very end of this notebook we ll also create a code whl code package which is uploaded updated in the dataset bioseq https www kaggle com shtrausslearning bioseq which includes classes used here code whl code is the format of packages used on pip these files can be uploaded to datasets installed via pip called as you would an existing pip package on Kaggle If you are interested in bioinformatics I d definitely recommend getting to know span style color 5D2ECC bioconductor span as well b 2 span style color F55AA2 span DEFINING A SEQUENCE OPERATIONS CLASS b div style color white display fill border radius 5px background color 323232 font size 220 font family Nexa letter spacing 0 5px p style padding 10px color white b 2 1 MAIN SEQUENCE CLASS b p div b span style color F55AA2 SEQUENCE OPERATION CLASS span b We define a custom class code SQ code which contains basic b sequence related operations b The b sequence class b code SQ code can be coupled with other classes that incorporate more sophisticated sequence based operations eg b sequence alignment b b SQ span style color F55AA2 CLASS METHODS span b CONSTRUCTOR code seq code String format of sequence code seq type code Sequence Character Type code id code Sequence Identifier code name code used to allocate a name to the sequence code description code used to show more information about the sequence code annotation code used to store annotation information about our sequence GENERAL METHODS code info code Show the sequence type span style color 5D2ECC information only span code abc code Show the span style color 5D2ECC alphabet characters span of the the sequence type code validate code Determine if the current span style color 5D2ECC sequence contains valid subsets span of charaters for its type COUNTING METHODS code freq code Calculate plot the span style color 5D2ECC frequencey of each character span in the alphabet of the define sequence span style color 5D2ECC type span code count purines code Count purines code A G code sum pyrimidines code C T code code groupfreq code Cound dinucleotides trincucleotide groupings in sequence code gc code Calculate the span style color 5D2ECC GC content span of the sequence STRAND METHODS code reverse comp code Rearrange the DNA sequnce to show its span style color 5D2ECC reverse complement sequence pair span PROTEIN GENERATION METHODS code transcription code Convert DNA sequence into an span style color 5D2ECC RNA sequence span code get protein code Derive all the span style color 5D2ECC amino acid chains span in span style color 5D2ECC all reading frames span and store as one sequence PATTERN IDENTIFICATION code find pattern code Find standard string patterns in the sequence more specialised specific patterns GENERATING SUBSEQUENCES code cut pattern code Cut sequence in specific parts based on a pattern b span style color F55AA2 MAPPING DICTIONAY span b Similar to BioPython s b CodonTable b as shown in Biopython for Bioinformatics Basics https www kaggle com shtrausslearning biopython for bioinformatics basics A dictionary containing mapping data between different combinations of mRNA nucleotides codons and b amino acids b is obtainable in b dic map b by setting b map id b to codon Similarly mapping between the IUPAC amino acid symbols names can be obtained by using b map id iupac amino b b map id iupac nucleotide b respectively b 3 span style color F55AA2 span BASIC SEQUENCE OPERATIONS b b span style color F55AA2 DEFINING A BASIC SEQUENCE span b We can create an instance of object code SQ code using the following including the b sequence type b The sequence and sequence type summary can be view by calling code info code method DNA sequences are also colour coded making it a little easier to distinguish the different characters b span style color F55AA2 CHECK ITS VALIDITY span b A sequence is valid if its alphabet corresponds to a specific set of code class b SQ b uses the IUPAC https www bioinformatics org sms2 iupac html code standard We can check whether a sequence is valid or not by using the code validate code function returning a logical output This can be handy when our sequece is very large and we can check the entire sequence for errors b span style color F55AA2 SWITCH TO ITS REVERSE COMPLEMENT span b DNA has span style color 5D2ECC two complementary strands span Due to the complementarity of the DNA strands usually only one of the strands is provided in a sequence file obtained from databases The second strand to the input b DNA sequence b can be obtained by calling the code reverse comp code function b span style color F55AA2 DEFINING A DETAILED SEQUENCE span b code SQ code can also be used to store more detailed information about our sequence Later we ll need to look at a sequence jot down some information about parts of the sequence after we have identified them as well b span style color F55AA2 MAKING ANNOTATIONS span b Say we searched a database to find if our sequence contains something interesting We have two hits span style color F55AA2 TTTT span span style color F55AA2 CCTCA span which we want to save in code annotation code Usually when we search databases we ll have a sequence identifier a description comment about the sequence so we ll be able to save this info The search result sequences can be extracted from the alignment format saved in code SQ code format Next we can find where it is located in the sequence using yet to be introduced method code find pattern code This will be handy in Section 8 where we ll be searching annotating a sequence of interest b 4 span style color F55AA2 span COUNTING CHARACTERS b b span style color F55AA2 NUCLEOTIDE AMINO ACID span b We may want to obtain the count for each each nucleotide or amino acid in the given sequence We can use the code freq code function to show The count percentage of each of the alphabet compare two sets of sequences with the addition of b compare b We may want to compare sequences of different length so in that case it s best to use percentage default code show id count code is good for when we just want to see the character count of sequence b span style color F55AA2 DI TRINUCLEOTIDES COUNTS span b We may want to know the different combinations of b span style color 5D2ECC double span b or b span style color 5D2ECC tripple nucleotides span b that is present within the sequence One example would be to count all the b span style color 5D2ECC codons span b present in a sequence b span style color F55AA2 GC CONTENT COUNTS span b From span style color 5D2ECC GC CONTENT span WIKIPEDIA https en wikipedia org wiki GC content SCIENCEDIRECT https www sciencedirect com topics biochemistry genetics and molecular biology gc content In molecular biology and genetics GC content or guanine cytosine content is the percentage of nitrogenous bases in a DNA or RNA molecule that are either b guanine b G or b cytosine b C This measure indicates the proportion of G and C bases out of an implied four total bases also including adenine and thymine in DNA and adenine and uracil in RNA GC content is strongly correlated with biological features of genome organization such as distribution of various classes of repeated elements gene density level and tissue specificity of transcription and mutation rate b span style color F55AA2 PURINES PYRIMIDINES COUNTS span b b span style color 5D2ECC purines span b adenine and guanine have a two ringed structure consisting of a nine membered molecule with four nitrogen atoms b span style color 5D2ECC pyrimidines span b cytosine uracil and thymine only have one single ring which has just six members and two nitrogen atoms b 5 span style color F55AA2 span DECODING DNA FOR PROTEIN GENERATION b div style color white display fill border radius 5px background color 323232 font size 220 font family Nexa letter spacing 0 5px p style padding 10px color white b 5 1 TRANSCRIPTION b p div The mRNA is created as the two complementary strands are split and is complement to one of the strands Transcription of b DNA sequence b can be obtained using the code transcription code function where the b T b is replaced by b U b in the sequence string div style color white display fill border radius 5px background color 323232 font size 220 font family Nexa letter spacing 0 5px p style padding 10px color white b 5 2 TRANSLATION b p div b span style color F55AA2 OVERVIEW span b The background to what happens during the translation process was already outlined in code 1 3 code however it makes sense to expand on theory a little more Proteins are synthesised by creating b chains of aminoacids b according to information contained in the b messenger RNA mRNA b in a process called b translation b b span style color F55AA2 START STOP CODONS span b b Translation b of a protein always begins with a specific codon b ATG b b M Methionine b which is always the first amino in the protein b Translation b process terminates when a stop codon is found b TAA b b TAG b b TGA b code code An example sequence where we know exactly where the b start b and b termination codons b are span style color F55AA2 ATG span code ACGGATCAGCCGCAAGCGGAATTGGCGTTTACGTACGATGCGCCG code span style color 5D2ECC TAA span We can note it span style color 5D2ECC starts with ATG span ends with span style color 5D2ECC one of the three stop codons span As the sequence follows the rule of start and ending codon in such a case we can use the b staticmethod b defined in SQ code translate p0 0 code directly Some interesting discussions about the starting amino acid https www researchgate net post Does every protein start with methionine ATG is usually the starting codon b span style color F55AA2 OPEN READING FRAME span b A b reading frame b is a way of dividing the DNA sequence into a set of consecutive b non overlapping triplet nucleotides b possible codons using dictionary mapping A given sequence has 3 possible reading frames first second and third nucleotide positions In addition considering there is another complementary strand we should compute the only 3 frames corresponding to the reverse compliment In many cases given a DNA sequence b we don t know in advance where the coding regions are b especially when dealing with complete sequences In such cases we need to b scan the DNA sequence for the coding region b First we need to divide and compute these reading frames 6 in total The code frames code function stores the converted 6 converted amino acid strings in a list b OPEN READING FRAME b genomove gov https www genome gov genetics glossary Open Reading Frame An open reading frame is a portion of a DNA molecule that when translated into amino acids contains no stop codons The genetic code reads DNA sequences in groups of three base pairs which means that a double stranded DNA molecule can read in any of six possible reading frames three in the forward direction and three in the reverse A long open reading frame is likely part of a gene Open Reading Frames ORF 1 https www genome gov genetics glossary Open Reading Frame img src https www genome gov sites default files tg en illustration open reading frame jpg alt Drawing style width 700px b span style color F55AA2 IDEAL CASE P 0 span b Let s try one of the reading frames at the start of the sequence b span style color 5D2ECC p0 0 span b which we know follows the correct rules observed in life Let s also consider all other possible ORFS get the final protein found in the DNA sequence Some interesting information about how many amino acids do we need to actually classify the decoded result as a protein proteins amino acids https www ncbi nlm nih gov books NBK234922 Both animal and plant proteins are made up of about 20 common amino acids We will mention those with less than about 20 amino acids below when we ll look at an example b 6 span style color F55AA2 span LOADING FILES CONTAINING SEQUENCES b b span style color F55AA2 REAL SEQUENCES span b Most realistic application of bioinformatics certainly involve working with b span style color 5D2ECC sequences that are too long span b Often we need to work with databases so it s convenient to have an effective I O system in place One of such formats is code FASTA code its made to be a very flexible format allowing us to work with single multiple or even alignment sequences b span style color F55AA2 THE FASTA FORMAT span b FASTA FASTA format https en wikipedia org wiki FASTA format In bioinformatics and biochemistry the FASTA format is a text based format for representing either b nucleotide sequences b or b amino acid protein sequences b in which nucleotides or amino acids are represented using single letter codes The format also allows for sequence names and comments to precede the sequences The format originates from the FASTA software package but has now become a near universal standard in the field of bioinformatics Commonly used to store nucleotide or protein sequences It s less detailed usually containing only the b span style color 5D2ECC sequence span b and b span style color 5D2ECC name header span b only b span style color 5D2ECC File extension span b Typically changed based on the b sequence type b content of the file defined below in the dictionary code FASTA dic code b span style color 5D2ECC Multisequences span b The format can contain any number of sequences each starting with the symbol b b The b span style color 5D2ECC name header span b defined after the symbol b b contains an origin identifier b span style color 5D2ECC NCBI identifiers span b defined in the the dictionary code identifiers dic code The NCBI defined a standard for the unique identifier used for the sequence SeqID in the header line This allows a sequence that was obtained from a database to be labelled with a reference to its database record The database identifier format is understood by the NCBI tools like makeblastdb and table2asn The following list describes the NCBI FASTA defined format for sequence identifiers b span style color F55AA2 READING SEQUENCE FILES CLASS span b We define a custom class code read seq code which methods used for reading the code FASTA code format The class automatically should detect the class type and call the corresponding class storing the sequence upon instantiation Sequences that are read are stored in code SQ code objects which allows us to also to also store additional information about the sequences b read seq span style color F55AA2 CLASS METHODS span b code self code The constructor stores the span style color 5D2ECC pathway span string its span style color 5D2ECC format type span code read FASTA code used to read code FASTA code formats storing sequence data in code lst seq code descriptions in code SQ code objects Two examples are shown below reading files code file faa code code file fna code containing a b set of protein sequences faa b and a b single nucleotide sequence fna b resepectively b 7 span style color F55AA2 span RECOGNISING PATTERNS b Another important part relating to sequences are pattern recognition within a sequence There are specific b span style color 5D2ECC patterns span b of nucleotides we can try to find in order to understand our sequence content a little more Having looked at the span style color 5D2ECC decoding of proteins span in Section 4 we might want to know more about our amino acid chains For example an amino acid chain containing the pattern Zinc finger RING type Prosite Database https prosite expasy org cgi bin prosite prosite search ac PDOC00022 Some proteins known to include a RING finger include Mammalian breast cancer type 1 susceptibility protein BRCA1 Let s load the Breast cancer type 1 susceptibility protein BRCA1 HUMAN https www uniprot org uniprot P38398 in FASTA format from the span style color 5D2ECC UniProtKB span database Using the loader from Section 5 to see if we have a match as well since they should be related Other ZnF types of prosite information github https proteinswebteam github io interpro blog potm 2007 3 Page1 htm b span style color F55AA2 PROSITE PATTERN FORMAT span b Looking at the example it should be quite clear what the below format rules mean Last point not currently added so you d need to be specific which case you re actualy searching for eg x 2 x 3 x 4 instead of x 2 4 Standard IUPAC amino acid used to as bases in pattern separated by x any amino acid acceptable ambiguity represented by list any aa in that list acceptable ambiguity represented by list any aa other than in accepted Repetition of pattern element shown below x 3 x x x x 2 4 to x x or x x x or x x x x b span style color F55AA2 STANDARD ABC PATTERNS span b We can use standard patterns of nucleotide amino acid subsequence as well for example code EES code b 8 span style color F55AA2 span CREATING SUBSEQUENCES b Our entire sequence may be very long we might have want cut the current sequence for a variety of purposes Example applications Where a full sequence was cut into non overlapping unitigs Identifying Antibiotic Resistant Bacteria https www kaggle com shtrausslearning identifying antibiotic resistant bacteria Where a full sequence was cut into a predefined sets of nucleotide bases OHE was used Transcription Factor Binding Location Prediction https www kaggle com shtrausslearning transcription factor binding location prediction b span style color 5D2ECC Restriction Enzymes span b can cut DNA sequences at particular segments of the DNA defined by a particular pattern we ll look at this here b span style color F55AA2 CREATING LISTS OF SUBSEQUENCES span b Whatever the mechanism the function code cut pattern code is general requiring us to specify where in the sequence a cut occurs using b span style color F55AA2 GENERATING OHE DNA FEATURES span b We can cut the sequence at a starting location number of characters that must be present in each sequence characters which aren t sufficient to create another segment the leftover characters are discarded b 9 span style color F55AA2 span COVID 19 PROTEIN IDENTIFICATION b b span style color F55AA2 READING DNA SEQUENCE FROM A DATABASE span b Having defined a class that can span style color 5D2ECC read span span style color 5D2ECC store span span style color 5D2ECC derive proteins span from a sequence file in the FASTA format we can use a database to obtain a real sequence Let s use the span style color 5D2ECC coronavirus genomoe sequence span already uploaded to Kaggle https www kaggle com paultimothymooney coronavirus genome sequence original source https www ncbi nlm nih gov nuccore NC 045512 b span style color F55AA2 BLAST DATABASE SEARCHING span b Steps we ll be taking 1 Get the b span style color 5D2ECC proteins span b encoded in the genome using code translate code 2 Identify the particular protein present pick some that interest us 3 Using a local sequence alignmnent tool called BLAST https blast ncbi nlm nih gov Blast cgi using class code BLASTwww code 3 Visualise the alignment so we can see which parts of the sequence match to that of the database We will look into b Local Sequence Alignment b in another notebook Biological Sequence Alignment https www kaggle com shtrausslearning custom class biological sequence alignment which BLAST uses However for the time being keeping things simple a protein sequence is compared to others already found in a database and returns very simular sequences b span style color F55AA2 USING THE NCBI API via Biopython span b To use the class function code BLASTwww code we ll first need to 1 decode the proteins from the DNA sequence 2 select a specific protein search for matching results in the database Below there are two functions that differ slightly both use the NCBI API to search databases code blast aav1 code Uses code NCBIXML read code in Biopython thus don t obtain the alignment alignment code BLASTwww code Uses code SearchIO read code in Biopython which enables us to visualise the alignment using code view code b span style color F55AA2 FUNCTIONAL PROTEINS OLIGOPEPTIDES span b Upon translation our b amino acid chains b aren t actually all proteins furthermore they Some extra criteria these chains must meet in order to be classified as proteins exist b Functional proteins b are chains above b 20 amino acids b Smaller chains are called oligopeptides https en wikipedia org wiki Oligopeptide 2 20 amino acids have other functionalities Let s select the b largest amino acid chain b found in the genome search for it in a databse so we can identify it Interestingly enough the largest amino acid chain actually differred from the Biopython result I tried in that notebook https www kaggle com shtrausslearning biopython bioinformatics basics Next let s choose a few search hit results plot them visualising the results code pdb 7MSW A code code pdb 6WUU A code If we have a hit we of course can search find more about this specific sequence in literature or databases We can see that our perfect hit case b span style color 5D2ECC pdb 7WUU A span b is not the entire sequence that we input visually can see its much smaller than our input We got a match for the the entire sequence using the b span style color 5D2ECC UniProt database span b However as we can see with the b span style color 5D2ECC pdb span b we only managed to identify sequences representing part of the protein which still gave us 100 match locally We can obtain the individual sequences from the alignment in the following way Using code find pattern code we can find where in out input sequence we actually got a hit b span style color F55AA2 MANUALLY SEARCHING OTHER DATABASES span b There are quite a few databses we only checked the pdb database not all are accessible via the NCBI API We might not actually find a match for the entire sequence all the time especially if it s as long as the one we have naturally it will likely contain different subsequences We can use this string copy paste this protein search for it using the PSI BLAST https www ebi ac uk Tools sss psiblast in order to find proteins already in a predefined database For the protein sequence that we searched for The results indicate that a 100 match was found with an already existing sequence in the database sp P0C6U8 R1A SARS Replicase polyprotein 1a https pubchem ncbi nlm nih gov protein P0C6U8 What is a b span style color F55AA2 polyprotein span b NCBI https www ncbi nlm nih gov pmc articles PMC7125721 Polyproteins are chains of covalently conjoined smaller proteins that occur in nature as versatile means to organize the proteome of viruses including HIV b span style color F55AA2 ANNOTATING OUR AMINO ACID SEQUENCE span b b 10 span style color F55AA2 span SUMMARY b b span style color F55AA2 CUSTOM CLASSES span b In this notebook we have defined a class that stores b basic information b about a specific sequence of interest Another class was also defined in order to read a commonly encountered format type b FASTA b b span style color F55AA2 OVERVIEW span b We also looked at common sequence related operations such as b transcription b b translation b which are quite critical concepts We also looked at some basic visualisation of the nucleotide amino acid distributions which can be helpful when comparing not only the b count b but also the percentage of each alphabet for the corresponding sequence type b span style color F55AA2 WHERE TO FROM HERE span b As with the b BioPython b module we have defined classes which store sequence data which can be expanded further The class b SQ b will be used as a basis for other sequence related operations such as b pairwise b b multiple sequence alignment b which due to their content size alone can have their own dedicated classes similar to the class b READ SEQ b which is dedicated to reading and passing on the sequence information to class b SQ b The notebook will of course be continuously updated and futher functions will be added in the future  display list neatly https stackoverflow com questions 1524126 how to print a list more nicely Mapping Dictionary Codon Amino Acid Conversion starting codon ending codon IUPAC Amino Acids IUPAC nuceotides Class for Sequence Operations Constructor Sequence String Sequence Type Sequence Identifier Sequene Name Sequence Description Core SQ If more detail is provided sequence identifier eg database id name of sequence eg polyprotein give the sequence some description Annotate some parts of the seqence class instance operations General Methods info show sequence information abc show sequence base alphabet validate check if the sequence contains no errors Get ABC Check Validity Counting freq count bases in sequence count purines count purines pyrimidines groupfreq count grouped bases Frequency of Symbols list of comparing sequences perc count abc counter for s1 Compare other sequences abc counter for s2 stack group overlay relative gap between bars of the same location coordinate Count frequency of grouped nucleotides cycle through all SQ Plot margin dict l 20 r 20 t 80 b 20 Return purines pyrimidines Return GC nucleotide Complementary DNA Strands reverse comp reverse complement strand of input DNA Reverse Complement Decoding of instructions for making proteins from DNA transcription DNA RNA get protein RNA AA chains containing proteins Transcription Translate store all possible collections of amino acid groups in all 6 frames using the knowledge that it starts with M and ends with filter out rule breaking ORFs aa seq full converted amino acid sequence stopping gap not stopping gap starting amino acid and sort them based on size order get all ORF conversions return only protein cases additionally sort based on protein size Finding Patterns in Sequence find pattern find index ies of particular pattern Prosite Pattern Lines Standard IUPAC amino acid used to as bases in pattern separated by x any amino acid acceptable ambiguity represented by list any aa in that list acceptable ambiguity represented by list any aa other than in accepted repetition of pattern element shown below x 3 x x x x 2 4 to x x or x x x or x x x x adjust prosite to RE format sequence of interest first all overlap None prosite General search as well Cutting the Sequence cut pattern cut sequence based on particular pattern converts IUB ambiguity code into RE returns cut position of a restriction enzyme in IUB code in a sequence main 4 bases purine pyrimidine amino keto strong weak not A not C not G not T not T any Additional Cases convert pattern to IUB format indicies of cuts determines subsequences resulting from a sequence cut in a list of positions Function for when you want to prepare DNA sequence feature for ML applications store sequence subsets in a dictionary One hot encode Annotating Sequence Notes add annotation add annotation method to add annotation to the current detailed sequence Define sequences in string format Define Two DNA sequences instances define new protein sequence Show class variables Defining some extra detail When required we can call the SQ object by using seq used for alignment naming etc compare content percentage default sequences w o id are set to default names Compare the nucleotide of three sequences list of sequences show the amino acid content of the protein Define Two DNA sequences instances Compare Trinucleotides of two sequences group stack group stack Sequence with initial codon coinciding with start codon end w end codon ATG TAA respectively Only one of the ORFs meets the requirement so only one putative protein is found NCBI identifiers FASTA formats Class to read different files and store info only if one of the fasta formats read FASTA format list of sequences list of sequence identifications get lines w get read sequences If there s more than one sequence return just the one file if valid sq define pathway to FASTA file amino acid chain sequence nucleotide sequence fetch sequence from file and store each in sequence class SQ seqrec objects Select only a subset as the strand is a little too big arbitrarily selected get all proteins with a length of more than 1 find id first find the first match index find id all find all non overlapping indicies find id overlap find all overlapping indicies Arbitrary cut pattern Search NCBI for a sequence store data for alignment store only first can be multi Class to access BioPython s blastwww plot alignments if present read xml search identifier used for save save search xml save metadata Find amino acid sequence in NCBI databases if not seq format fetch the id description evalue bitscore alignment DNA clrs A red T green G orange C blue white IUPAC aa View BLAST alignment using Bokeh make sequence and id lists from the aln object creates a 2D grid of coords from the 1D arrays flattens the arrays use recty for rect coords with an offset now we can create the ColumnDataSource with all the arrays view range is for the close up view entire sequence view no text with zoom sequence text view with ability to scroll along x axis lod factor 1 Read FASTA format containing Covid Genome read and store FNA data Store the sequence defining a SQ class instance The sequence is a bit too long lets show the first 1000 characters The virus contains a heavy portion of Thymine Adenine 63 Get all amino acid chains above default 1 interpret xml w NCBIXML search res blast aav1 largest aa pdb search for aa chain in pdb databse search res head stored in hit order search res to csv kaggle working search blast csv Best hit choose an alignment view alignment save metadata alignments arent actually saved to save alignments just save xml of BLAST search ", "id": "shtrausslearning/biological-sequence-operations", "size": "39968", "language": "python", "html_url": "https://www.kaggle.com/code/shtrausslearning/biological-sequence-operations", "git_url": "https://www.kaggle.com/code/shtrausslearning/biological-sequence-operations"}